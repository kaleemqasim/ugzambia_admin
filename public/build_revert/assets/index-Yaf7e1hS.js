import{_ as V,d as L,b as I,z as B,a6 as T,V as j,o as p,g as P,w as a,a as t,h as A,j as o,t as r,i as k,c as b,D as h,a1 as F,aR as G,aM as O,aL as Q,E as W,aN as D,G as J,q as E,f as U,e as K,r as N,cg as R,k as X,p as x,L as Y,ay as Z,aB as ee,aC as te,aQ as ae,aD as ne,aG as oe}from"./app-OikDM5Kw.js";import{d as q}from"./datatable-DjynKO_7.js";import{A as re}from"./AdminPageHeader-MbAN4P4t.js";import{U as se}from"./UserInfo-4wSQ2hbz.js";import{c as le,E as de}from"./ExportTable-CioT-h8X.js";import{P as ie}from"./PaymentStatus-CjQCOJGj.js";import"./filter-CQCFHrIe.js";import"./index-CaGusbUe.js";import"./PrinterOutlined-DKHuCtDd.js";import"./fields-Bh473hAH.js";const _e=L({props:{category_id:null,brand_id:null},components:{UserInfo:se,PaymentStatus:ie},setup(e){const{summaryColumns:d,hashableColumns:v}=le(),{formatDateTime:i,formatAmountCurrency:C,selectedWarehouse:w}=I(),_=q();B(()=>{f(e)});const f=n=>{const l={};n.category_id&&n.category_id!=null&&(l.category_id=n.category_id),n.brand_id&&n.brand_id!=null&&(l.brand_id=n.brand_id),_.tableUrl.value={url:"products?fields=id,xid,name,,item_code,image,image_url,category_id,x_category_id,category{id,xid,name},brand_id,x_brand_id,brand{id,xid,name},unit_id,x_unit_id,unit{id,xid,name,short_name},details{stock_quantitiy_alert,opening_stock,opening_stock_date,wholesale_price,wholesale_quantity,mrp,purchase_price,sales_price,tax_id,x_tax_id,purchase_tax_type,sales_tax_type,current_stock,warehouse_id,x_warehouse_id,status},details:tax{id,xid,name,rate}",filters:l},_.hashable.value=[...v],_.table.sorter={field:"name",order:"asc"},_.exportDetails.value={allowExport:!0,exportType:"stock_summary_reports"},_.fetch({page:1})};T(e,(n,l)=>{f(n)}),T(w,(n,l)=>{f(e)});const c=j(()=>{let n=0,l=0,g=0;return _.table.data.forEach(u=>{n+=u.details.current_stock,l+=u.details.current_stock*u.details.sales_price,g+=u.details.current_stock*u.details.purchase_price}),{totalCurrentStock:n,totalSalesPrice:l,totalPurchasePrice:g}});return{summaryColumns:d,..._,formatDateTime:i,formatAmountCurrency:C,totals:c}}}),ue={class:"table-responsive"};function ce(e,d,v,i,C,w){const _=F,f=G,c=O,n=Q,l=W,g=D,u=J,$=E,S=U;return p(),P(S,null,{default:a(()=>[t($,{span:24},{default:a(()=>[A("div",ue,[t(u,{columns:e.summaryColumns,"row-key":m=>m.xid,"data-source":e.table.data,pagination:e.table.pagination,loading:e.table.loading,onChange:e.handleTableChange,id:"stock-summary-reports-table",bordered:"",size:"middle"},{bodyCell:a(({column:m,record:s})=>[m.dataIndex==="name"?(p(),P(f,{key:0},{default:a(()=>[t(_,{shape:"square",src:s.image_url},null,8,["src"]),o(" "+r(s.name),1)]),_:2},1024)):k("",!0),m.dataIndex==="category_id"?(p(),b(h,{key:1},[o(r(s.category.name),1)],64)):k("",!0),m.dataIndex==="brand_id"?(p(),b(h,{key:2},[o(r(s.brand&&s.brand.xid?s.brand.name:"-"),1)],64)):k("",!0),m.dataIndex==="sales_price"?(p(),b(h,{key:3},[o(r(e.formatAmountCurrency(s.details.sales_price)),1)],64)):k("",!0),m.dataIndex==="purchase_price"?(p(),b(h,{key:4},[o(r(e.formatAmountCurrency(s.details.purchase_price)),1)],64)):k("",!0),m.dataIndex==="current_stock"?(p(),b(h,{key:5},[o(r(`${s.details.current_stock} ${s.unit.short_name}`),1)],64)):k("",!0),m.dataIndex==="stock_value"?(p(),b(h,{key:6},[o(r(e.$t("product.by_purchase"))+" : ",1),t(c,{strong:""},{default:a(()=>[o(r(e.formatAmountCurrency(s.details.current_stock*s.details.purchase_price)),1)]),_:2},1024),d[0]||(d[0]=A("br",null,null,-1)),o(" "+r(e.$t("product.by_sales"))+" : ",1),t(c,{strong:""},{default:a(()=>[o(r(e.formatAmountCurrency(s.details.current_stock*s.details.sales_price)),1)]),_:2},1024)],64)):k("",!0)]),summary:a(()=>[t(g,null,{default:a(()=>[t(n,{"col-span":5}),t(n,{"col-span":1},{default:a(()=>[t(c,{strong:""},{default:a(()=>[o(r(e.$t("common.total")),1)]),_:1})]),_:1}),t(n,{"col-span":1},{default:a(()=>[t(c,{strong:""},{default:a(()=>[t(l,null,{default:a(()=>[o(r(e.totals.totalCurrentStock),1)]),_:1})]),_:1})]),_:1}),t(n,{"col-span":1},{default:a(()=>[o(r(e.$t("product.by_purchase"))+" : ",1),t(c,{strong:""},{default:a(()=>[t(l,null,{default:a(()=>[o(r(e.formatAmountCurrency(e.totals.totalPurchasePrice)),1)]),_:1})]),_:1}),d[1]||(d[1]=A("br",null,null,-1)),o(" "+r(e.$t("product.by_sales"))+" : ",1),t(c,{strong:""},{default:a(()=>[t(l,null,{default:a(()=>[o(r(e.formatAmountCurrency(e.totals.totalSalesPrice)),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["columns","row-key","data-source","pagination","loading","onChange"])])]),_:1})]),_:1})}const me=V(_e,[["render",ce]]),pe={components:{AdminPageHeader:re,StockSummary:me,ExprotTable:de},setup(){const e=q(),{permsArray:d,getRecursiveCategories:v,filterTreeNode:i,willSubscriptionModuleVisible:C}=I(),w=K({category_id:void 0,brand_id:void 0}),_=N([]),f=N([]),c=X();R(()=>{(!(d.value.includes("products_view")||d.value.includes("admin"))||!C("reports"))&&c.push("admin.dashboard.index")}),B(()=>{n()});const n=()=>{const l=axiosAdmin.get("categories?limit=10000"),g=axiosAdmin.get("brands?limit=10000");Promise.all([l,g]).then(([u,$])=>{_.value=v(u),f.value=$.data})};return{...e,filters:w,categories:_,brands:f,permsArray:d,filterTreeNode:i}}};function fe(e,d,v,i,C,w){const _=x("ExprotTable"),f=Z,c=x("router-link"),n=ee,l=te,g=x("AdminPageHeader"),u=E,$=ae,S=oe,m=ne,s=U,H=x("admin-page-filters"),M=x("StockSummary"),z=x("admin-page-table-content");return p(),b(h,null,[t(g,null,{header:a(()=>[t(f,{title:e.$t("menu.stock_summary"),class:"p-0"},{extra:a(()=>[t(_,{exportType:"stock_summary_reports",tableName:"stock-summary-reports-table",title:`${e.$t("menu.stock_summary")} ${e.$t("menu.reports")}`},null,8,["title"])]),_:1},8,["title"])]),breadcrumb:a(()=>[t(l,{separator:"-",style:{"font-size":"12px"}},{default:a(()=>[t(n,null,{default:a(()=>[t(c,{to:{name:"admin.dashboard.index"}},{default:a(()=>[o(r(e.$t("menu.dashboard")),1)]),_:1})]),_:1}),t(n,null,{default:a(()=>[o(r(e.$t("menu.reports")),1)]),_:1}),t(n,null,{default:a(()=>[o(r(e.$t("menu.stock_summary")),1)]),_:1})]),_:1})]),_:1}),t(H,null,{default:a(()=>[t(s,{gutter:[16,16]},{default:a(()=>[t(u,{xs:24,sm:24,md:12,lg:10,xl:10}),t(u,{xs:24,sm:24,md:12,lg:14,xl:14},{default:a(()=>[t(s,{gutter:[16,16],justify:"end"},{default:a(()=>[t(u,{xs:24,sm:24,md:8,lg:6,xl:6},{default:a(()=>[t($,{value:i.filters.category_id,"onUpdate:value":d[0]||(d[0]=y=>i.filters.category_id=y),"show-search":"",style:{width:"100%"},"dropdown-style":{maxHeight:"250px",overflow:"auto"},placeholder:e.$t("common.select_default_text",[e.$t("category.category")]),"tree-data":i.categories,"allow-clear":"","tree-default-expand-all":"",filterTreeNode:i.filterTreeNode},null,8,["value","placeholder","tree-data","filterTreeNode"])]),_:1}),t(u,{xs:24,sm:24,md:8,lg:6,xl:6},{default:a(()=>[t(m,{value:i.filters.brand_id,"onUpdate:value":d[1]||(d[1]=y=>i.filters.brand_id=y),placeholder:e.$t("common.select_default_text",[e.$t("product.brand")]),allowClear:!0,style:{width:"100%"},optionFilterProp:"title","show-search":""},{default:a(()=>[(p(!0),b(h,null,Y(i.brands,y=>(p(),P(S,{key:y.xid,title:y.name,value:y.xid},{default:a(()=>[o(r(y.name),1)]),_:2},1032,["title","value"]))),128))]),_:1},8,["value","placeholder"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),t(z,null,{default:a(()=>[t(M,{category_id:i.filters.category_id,brand_id:i.filters.brand_id},null,8,["category_id","brand_id"])]),_:1})],64)}const Se=V(pe,[["render",fe]]);export{Se as default};
