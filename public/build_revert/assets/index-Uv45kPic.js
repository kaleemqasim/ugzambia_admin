import{S as V}from"./SettingSidebar-D526a_C1.js";import{A as R}from"./AdminPageHeader-MbAN4P4t.js";import{au as w,Y as O,_ as B,Q as D,az as W,aA as L,aH as S,r as A,z as j,p as r,o as $,c as T,a,w as t,S as F,h as C,g as E,j as _,t as u,i as Q,D as x,X as G,q as I,f as P,l as H,ar as U,B as z,a0 as M,G as X,d as N,aT as Y,aM as J,bh as K,ap as Z,ay as ee,aB as ae,aC as te}from"./app-OikDM5Kw.js";import{a as ne}from"./apiAdmin-yFrp6bZq.js";import{S as oe}from"./SaveOutlined-BSR-wlKo.js";import{S as se}from"./SettingOutlined-DBG_v97O.js";import"./TranslationOutlined-CEPKXLet.js";import"./UserOutlined-6nf3lw0h.js";import"./ShoppingCartOutlined-BldUIlX-.js";import"./ScheduleOutlined-Dj7wWgnj.js";import"./AppstoreAddOutlined-BIf-P8Dc.js";import"./MailOutlined-DcsIPfhp.js";import"./FormOutlined-VUqFOjZT.js";import"./index-CaGusbUe.js";const ce=()=>{const e=w("database-backups"),{t:c}=O(),n=[{title:c("database_backup.file"),dataIndex:"name",sorter:!0},{title:c("database_backup.file_size"),dataIndex:"size",sorter:!0},{title:c("common.action"),dataIndex:"action"}];return{url:e,columns:n}},le={components:{PlusOutlined:D,EditOutlined:W,DeleteOutlined:L,ExclamationCircleOutlined:S},setup(){const{t:e}=O(),{url:c,columns:n}=ce(),s=A([]);return j(()=>{axiosAdmin.post(w("database-backups")).then(o=>{s.value=o.data.data})}),{columns:n,results:s,deleteBackup:o=>{G.confirm({title:e("database_backup.delete_backup"),icon:a(S),content:e("database_backup.are_you_sure_delete_backup"),okText:e("common.yes"),okType:"danger",cancelText:e("common.no"),onOk(){axiosAdmin.post(w("delete-backup"),{file_name:o}).then(l=>{s.value=l.data.data})},onCancel(){}})},backupCreated:o=>{s.value=o.data}}}},_e={class:"table-responsive mt-20"};function ue(e,c,n,s,i,k){const o=I,l=P,p=r("admin-page-filters"),m=H,b=U,d=z,g=M,f=X,v=r("admin-page-table-content");return $(),T(x,null,[a(p,null,{default:t(()=>[a(l,{gutter:[16,16]},{default:t(()=>[a(o,{span:24},{default:t(()=>[F(e.$slots,"actionButtons")]),_:3})]),_:3})]),_:3}),a(v,null,{default:t(()=>[a(l,{class:"mt-20"},{default:t(()=>[a(o,{span:24},{default:t(()=>[a(m,{type:"warning",showIcon:"",message:e.$t("database_backup.backup_locaion_is")},null,8,["message"]),C("div",_e,[a(f,{columns:s.columns,"row-key":y=>y.id,"data-source":s.results,pagination:!1,bordered:"",size:"middle"},{bodyCell:t(({column:y,record:h})=>[y.dataIndex=="action"?($(),E(g,{key:0},{default:t(()=>[a(b,{href:h.url,target:"_blank"},{default:t(()=>[_(u(e.$t("common.download")),1)]),_:2},1032,["href"]),a(d,{type:"link",onClick:q=>s.deleteBackup(h.name)},{default:t(()=>[_(u(e.$t("common.delete")),1)]),_:2},1032,["onClick"])]),_:2},1024)):Q("",!0)]),_:1},8,["columns","row-key","data-source"])])]),_:1})]),_:1})]),_:1})],64)}const re=B(le,[["render",ue]]),pe=N({emits:["success"],components:{PlusOutlined:D,ExclamationCircleOutlined:S},setup(e,{emit:c}){const{t:n}=O(),{addEditRequestAdmin:s,loading:i}=ne();return{generateBack:()=>{G.confirm({title:n("database_backup.generate_backup"),icon:a(S),content:n("database_backup.are_you_sure_generate_backup"),okText:n("common.yes"),okType:"danger",cancelText:n("common.no"),onOk(){s({url:w("generate-backups"),data:{},successMessage:n("database_backup.backup_generated_successfully"),success:o=>{c("success",o)}})},onCancel(){}})},loading:i}}});function de(e,c,n,s,i,k){const o=r("PlusOutlined"),l=z;return $(),E(l,{type:"primary",onClick:e.generateBack,loading:e.loading},{default:t(()=>[a(o),_(" "+u(e.$t("database_backup.generate_backup")),1)]),_:1},8,["onClick","loading"])}const ie=B(pe,[["render",de]]),me=N({components:{PlusOutlined:D,LoadingOutlined:Y,SaveOutlined:oe,SettingOutlined:se},setup(){const e=A(!1);return{visible:e,onClose:()=>{e.value=!1},openDrawer:()=>{e.value=!0},drawerWidth:window.innerWidth<=991?"90%":"35%"}}});function be(e,c,n,s,i,k){const o=r("SettingOutlined"),l=z,p=H,m=I,b=P,d=J,g=K,f=Z;return $(),T(x,null,[a(l,{type:"primary",onClick:e.openDrawer},{icon:t(()=>[a(o)]),default:t(()=>[_(" "+u(e.$t("database_backup.settings")),1)]),_:1},8,["onClick"]),a(f,{title:e.$t("database_backup.backup_command_setting"),width:e.drawerWidth,open:e.visible,"body-style":{paddingBottom:"80px"},"footer-style":{textAlign:"right"},maskClosable:!1,onClose:e.onClose},{footer:t(()=>[a(l,{onClick:e.onClose},{default:t(()=>[_(u(e.$t("common.cancel")),1)]),_:1},8,["onClick"])]),default:t(()=>[a(b,{gutter:16,class:"mb-10"},{default:t(()=>[a(m,{span:24},{default:t(()=>[a(p,{type:"warning",showIcon:"",message:e.$t("database_backup.put_dump_path_command_on_env_file")},null,8,["message"])]),_:1})]),_:1}),a(b,{gutter:16},{default:t(()=>[a(m,{span:24},{default:t(()=>[a(g,null,{default:t(()=>[C("blockquote",null,[a(d,{type:"warning"},{default:t(()=>[_(u(e.$t("database_backup.window_command_path")),1)]),_:1})]),C("blockquote",null,[a(d,{type:"warning"},{default:t(()=>[_(u(e.$t("database_backup.laragon_command_path")),1)]),_:1})]),C("blockquote",null,[a(d,{type:"warning"},{default:t(()=>[_(u(e.$t("database_backup.linux_command_path")),1)]),_:1})])]),_:1})]),_:1})]),_:1})]),_:1},8,["title","width","open","onClose"])],64)}const ge=B(me,[["render",be]]),ke={components:{SettingSidebar:V,AdminPageHeader:R,DatabaseSettings:re,GenerateDbBackup:ie,BackupCommandSetting:ge},setup(){const e=A(null);return{backupCreated:n=>{e.value.backupCreated(n)},settingRef:e}}};function fe(e,c,n,s,i,k){const o=ee,l=r("router-link"),p=ae,m=te,b=r("AdminPageHeader"),d=r("SettingSidebar"),g=I,f=r("GenerateDbBackup"),v=r("BackupCommandSetting"),y=M,h=r("DatabaseSettings"),q=P;return $(),T(x,null,[a(b,null,{header:t(()=>[a(o,{title:e.$t("menu.database_backup"),class:"p-0"},null,8,["title"])]),breadcrumb:t(()=>[a(m,{separator:"-",style:{"font-size":"12px"}},{default:t(()=>[a(p,null,{default:t(()=>[a(l,{to:{name:"admin.dashboard.index"}},{default:t(()=>[_(u(e.$t("menu.dashboard")),1)]),_:1})]),_:1}),a(p,null,{default:t(()=>[_(u(e.$t("menu.settings")),1)]),_:1}),a(p,null,{default:t(()=>[_(u(e.$t("menu.database_backup")),1)]),_:1})]),_:1})]),_:1}),a(q,null,{default:t(()=>[a(g,{xs:24,sm:24,md:24,lg:4,xl:4,class:"bg-setting-sidebar"},{default:t(()=>[a(d)]),_:1}),a(g,{xs:24,sm:24,md:24,lg:20,xl:20},{default:t(()=>[a(h,{ref:"settingRef"},{actionButtons:t(()=>[a(y,null,{default:t(()=>[a(f,{onSuccess:s.backupCreated},null,8,["onSuccess"]),a(v)]),_:1})]),_:1},512)]),_:1})]),_:1})],64)}const Pe=B(ke,[["render",fe]]);export{Pe as default};
