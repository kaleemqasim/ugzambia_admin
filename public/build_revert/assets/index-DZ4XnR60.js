import{A as G,f as Q}from"./AddEdit-BG4Pk-kE.js";import{_ as X,Q as Y,az as J,aA as L,aH as O,b as W,Y as Z,r as m,z as $,V as ee,c as N,a as t,w as n,D as K,X as M,ax as j,ak as te,p as c,o as _,j as v,t as A,g as b,i as f,h as ae,u as ne,aI as oe,ay as se,aB as le,aC as ie,B as de,a0 as re,q as ce,f as me,G as ue,al as _e}from"./app-OikDM5Kw.js";import{A as pe}from"./AdminPageHeader-MbAN4P4t.js";import{I as ge}from"./Import-DCvZ1G84.js";import"./apiAdmin-yFrp6bZq.js";import"./Upload-D5F1bEQ_.js";import"./SaveOutlined-BSR-wlKo.js";import"./index-CaGusbUe.js";import"./UploadFile-DR1pWrT7.js";import"./CloudDownloadOutlined-CJYOjgRr.js";const fe={components:{PlusOutlined:Y,EditOutlined:J,DeleteOutlined:L,ExclamationCircleOutlined:O,AddEdit:G,AdminPageHeader:pe,ImportCategories:ge},setup(){const l=ne(),{initData:T,columns:P}=Q(),{permsArray:e}=W(),{t:o}=Z(),U=window.config.category_sample_file,w=m(!1),y=m({}),i=m(!1),p=m("add"),h=m("categories"),E=m([]),d=m({}),g=m([]);$(()=>{r()});const I=a=>{g.value=a},D=a=>({disabled:!(!a.children||a.children.length==0),name:a.xid}),C=ee(()=>({selectedRowKeys:oe(g),onChange:I,getCheckboxProps:D})),r=()=>{axiosAdmin.get("categories?fields=id,xid,name,slug,parent_id,x_parent_id,image,image_url&order=parent_id asc&limit=10000").then(a=>{const s=[];var u=a.data;u.forEach(k=>{if(!k.x_parent_id)return s.push(k);const S=u.findIndex(q=>q.xid===k.x_parent_id);if(!u[S].children)return u[S].children=[k];u[S].children.push(k)}),E.value=s})};return{columns:P,addEditSuccess:a=>{p.value=="add"&&(d.value={name:"",slug:"",image:void 0,image_url:void 0,parent_id:null}),r(),i.value=!1},formData:d,editItem:a=>{d.value={name:a.name,slug:a.slug,image:a.image,image_url:a.image_url,parent_id:a.x_parent_id,_method:"PUT"},y.value=a,h.value=`categories/${a.xid}`,p.value="edit",i.value=!0},addEditVisible:i,addItem:()=>{h.value="categories",p.value="add",i.value=!0},onCloseAddEdit:()=>{d.value={...T},i.value=!1},addEditUrl:h,addEditType:p,showDeleteConfirm:a=>{M.confirm({title:o("common.delete")+"?",icon:t(O),content:o("category.delete_message"),centered:!0,okText:o("common.yes"),okType:"danger",cancelText:o("common.no"),onOk(){axiosAdmin.delete(`categories/${a}`).then(()=>{r(),j.success({message:o("common.success"),description:o("category.deleted")})})},onCancel(){}})},detailsVisible:w,viewItem:a=>{y.value=a,w.value=!0},viewData:y,allCategories:E,permsArray:e,sampleFileUrl:U,getCategories:r,selectedRowKeys:g,rowSelection:C,showSelectedDeleteConfirm:()=>{M.confirm({title:o("common.delete")+"?",icon:t(O),content:o("category.delete_message"),centered:!0,okText:o("common.yes"),okType:"danger",cancelText:o("common.no"),onOk(){const a=[];te(g.value,s=>{a.push(axiosAdmin.delete(`categories/${s}`))}),Promise.all(a).then(s=>{l.dispatch("auth/updateVisibleSubscriptionModules"),r(),j.success({message:o("common.success"),description:o("category.deleted"),placement:"bottomRight"})})},onCancel(){}})}}}},ye={class:"table-responsive"};function he(l,T,P,e,o,U){const w=se,y=c("router-link"),i=le,p=ie,h=c("AdminPageHeader"),E=c("PlusOutlined"),d=de,g=c("ImportCategories"),I=re,D=c("DeleteOutlined"),C=ce,r=me,V=c("admin-page-filters"),B=c("AddEdit"),R=_e,F=c("EditOutlined"),z=ue,H=c("admin-page-table-content");return _(),N(K,null,[t(h,null,{header:n(()=>[t(w,{title:l.$t("menu.categories"),class:"p-0"},null,8,["title"])]),breadcrumb:n(()=>[t(p,{separator:"-",style:{"font-size":"12px"}},{default:n(()=>[t(i,null,{default:n(()=>[t(y,{to:{name:"admin.dashboard.index"}},{default:n(()=>[v(A(l.$t("menu.dashboard")),1)]),_:1})]),_:1}),t(i,null,{default:n(()=>[v(A(l.$t("menu.product_manager")),1)]),_:1}),t(i,null,{default:n(()=>[v(A(l.$t("menu.categories")),1)]),_:1})]),_:1})]),_:1}),t(V,null,{default:n(()=>[t(r,{gutter:[16,16]},{default:n(()=>[t(C,{xs:24,sm:24,md:12,lg:10,xl:10},{default:n(()=>[t(I,null,{default:n(()=>[e.permsArray.includes("categories_create")||e.permsArray.includes("admin")?(_(),b(I,{key:0},{default:n(()=>[t(d,{type:"primary",onClick:e.addItem},{default:n(()=>[t(E),v(" "+A(l.$t("category.add")),1)]),_:1},8,["onClick"]),t(g,{pageTitle:l.$t("category.import_categories"),sampleFileUrl:e.sampleFileUrl,importUrl:"categories/import",onOnUploadSuccess:e.getCategories},null,8,["pageTitle","sampleFileUrl","onOnUploadSuccess"])]),_:1})):f("",!0),e.selectedRowKeys.length>0&&(e.permsArray.includes("categories_delete")||e.permsArray.includes("admin"))?(_(),b(d,{key:1,type:"primary",onClick:e.showSelectedDeleteConfirm,danger:""},{icon:n(()=>[t(D)]),default:n(()=>[v(" "+A(l.$t("common.delete")),1)]),_:1},8,["onClick"])):f("",!0)]),_:1})]),_:1}),t(C,{xs:24,sm:24,md:12,lg:14,xl:14},{default:n(()=>[t(r,{gutter:[16,16],justify:"end"})]),_:1})]),_:1})]),_:1}),t(H,null,{default:n(()=>[t(B,{addEditType:e.addEditType,visible:e.addEditVisible,url:e.addEditUrl,onAddEditSuccess:e.addEditSuccess,onClosed:e.onCloseAddEdit,formData:e.formData,data:e.viewData,destroyOnClose:!0},null,8,["addEditType","visible","url","onAddEditSuccess","onClosed","formData","data"]),t(r,null,{default:n(()=>[t(C,{span:24},{default:n(()=>[ae("div",ye,[t(z,{"row-selection":e.rowSelection,columns:e.columns,"row-key":x=>x.xid,"data-source":e.allCategories,defaultExpandAllRows:!0,bordered:"",size:"middle"},{bodyCell:n(({column:x,text:a,record:s})=>[x.dataIndex==="image_url"?(_(),b(R,{key:0,width:32,src:a},null,8,["src"])):f("",!0),x.dataIndex==="action"?(_(),N(K,{key:1},[e.permsArray.includes("categories_edit")||e.permsArray.includes("admin")?(_(),b(d,{key:0,type:"primary",onClick:u=>e.editItem(s),style:{"margin-left":"4px"}},{icon:n(()=>[t(F)]),_:2},1032,["onClick"])):f("",!0),(e.permsArray.includes("categories_delete")||e.permsArray.includes("admin"))&&(!s.children||s.children.length==0)?(_(),b(d,{key:1,type:"primary",onClick:u=>e.showDeleteConfirm(s.xid),style:{"margin-left":"4px"}},{icon:n(()=>[t(D)]),_:2},1032,["onClick"])):f("",!0)],64)):f("",!0)]),_:1},8,["row-selection","columns","row-key","data-source"])])]),_:1})]),_:1})]),_:1})],64)}const Se=X(fe,[["render",he]]);export{Se as default};
