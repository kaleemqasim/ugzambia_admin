import{_ as G,Q as x,az as Q,aA as W,b as J,e as X,r as Y,z as Z,V as $,a6 as M,c as g,a as t,w as a,D as b,p as _,o as l,j as r,t as i,g as f,i as c,L as R,h as ee,y as ae,ay as te,aB as ne,aC as oe,B as le,a0 as se,q as de,aD as re,aE as ie,aF as me,f as ue,aL as _e,aM as pe,aN as ce,G as ye,aG as fe}from"./app-OikDM5Kw.js";import{A as ge,f as be}from"./AddEdit-BqrKUUq7.js";import{c as he}from"./crud-BXjQ0O-i.js";import{A as ve}from"./AdminPageHeader-MbAN4P4t.js";import{U as Ce}from"./UserInfo-4wSQ2hbz.js";import"./apiAdmin-yFrp6bZq.js";import"./AddButton-SD-wiXX7.js";import"./AddEdit-M237dgh9.js";import"./SaveOutlined-BSR-wlKo.js";import"./DateTimePicker-CSM27X8x.js";import"./datatable-DjynKO_7.js";import"./filter-CQCFHrIe.js";import"./index-CaGusbUe.js";const ke={components:{PlusOutlined:x,EditOutlined:Q,DeleteOutlined:W,AddEdit:ge,AdminPageHeader:ve,UserInfo:Ce},setup(){const{addEditUrl:e,initData:d,columns:O,paymentType:n,menuParent:D,hashableColumns:V,filterableColumns:A}=be(),s=he(),{permsArray:h,formatAmountCurrency:E,selectedWarehouse:S,formatDate:P}=J(),p=X({user_id:void 0}),v=Y({}),C=ae();Z(()=>{w(),m()});const m=()=>{s.tableUrl.value={url:`payment-${n.value}?fields=id,xid,date,amount,notes,payment_mode_id,payment_number,payment_type,payment_mode_id,x_payment_mode_id,paymentMode{id,xid,name},user_id,x_user_id,user{id,xid,name,profile_image,profile_image_url,user_type}`,filterString:`payment_type eq "${n.value}"`,filters:p},s.table.filterableColumns=A,s.fetch({page:1}),s.crudUrl.value=e.value,s.langKey.value="payments",s.initData.value={...d.value},s.formData.value={...d.value},s.hashableColumns.value=[...V]},w=()=>{const u=axiosAdmin.post("customer-suppliers");Promise.all([u]).then(([y])=>{v.value=y.data})},T=$(()=>{let u=0;return s.table.data.forEach(y=>{u+=y.amount}),{totalAmount:u}});return M(S,(u,y)=>{m()}),M(()=>C.meta.paymentType,(u,y)=>{(u=="in"||u=="out")&&(n.value=C.meta.paymentType,D.value=C.meta.menuParent,e.value=`payment-${n.value}`,d.value={...d.value,payment_type:n.value},p.user_id=void 0,m())}),{columns:O,...s,permsArray:h,formatAmountCurrency:E,paymentType:n,menuParent:D,filters:p,users:v,setUrlData:m,filterableColumns:A,formatDate:P,totals:T}}},Ae={class:"table-responsive"};function we(e,d,O,n,D,V){const A=te,s=_("router-link"),h=ne,E=oe,S=_("AdminPageHeader"),P=_("PlusOutlined"),p=le,v=_("DeleteOutlined"),C=se,m=de,w=fe,T=re,u=ie,y=me,U=ue,N=_("admin-page-filters"),z=_("AddEdit"),K=_("UserInfo"),L=_("EditOutlined"),I=_e,B=pe,F=ce,H=ye,j=_("admin-page-table-content");return l(),g(b,null,[t(S,null,{header:a(()=>[t(A,{title:e.$t(`menu.payment_${n.paymentType}`),class:"p-0"},null,8,["title"])]),breadcrumb:a(()=>[t(E,{separator:"-",style:{"font-size":"12px"}},{default:a(()=>[t(h,null,{default:a(()=>[t(s,{to:{name:"admin.dashboard.index"}},{default:a(()=>[r(i(e.$t("menu.dashboard")),1)]),_:1})]),_:1}),t(h,null,{default:a(()=>[r(i(e.$t(`menu.${n.menuParent}`)),1)]),_:1}),t(h,null,{default:a(()=>[r(i(e.$t(`menu.payment_${n.paymentType}`)),1)]),_:1})]),_:1})]),_:1}),t(N,null,{default:a(()=>[t(U,{gutter:[16,16]},{default:a(()=>[t(m,{xs:24,sm:24,md:12,lg:10,xl:10},{default:a(()=>[t(C,null,{default:a(()=>[n.permsArray.includes(n.paymentType=="in"?"payment_in_create":"payment_out_create")||n.permsArray.includes("admin")?(l(),f(p,{key:0,type:"primary",onClick:e.addItem},{default:a(()=>[t(P),r(" "+i(e.$t("payments.add")),1)]),_:1},8,["onClick"])):c("",!0),e.table.selectedRowKeys.length>0&&(n.permsArray.includes(n.paymentType=="in"?"payment_in_delete":"payment_out_delete")||n.permsArray.includes("admin"))?(l(),f(p,{key:1,type:"primary",onClick:e.showSelectedDeleteConfirm,danger:""},{icon:a(()=>[t(v)]),default:a(()=>[r(" "+i(e.$t("common.delete")),1)]),_:1},8,["onClick"])):c("",!0)]),_:1})]),_:1}),t(m,{xs:24,sm:24,md:12,lg:14,xl:14},{default:a(()=>[t(U,{gutter:[16,16],justify:"end"},{default:a(()=>[t(m,{xs:24,sm:24,md:12,lg:6,xl:8},{default:a(()=>[t(y,{compact:""},{default:a(()=>[t(T,{style:{width:"25%"},value:e.table.searchColumn,"onUpdate:value":d[0]||(d[0]=o=>e.table.searchColumn=o),placeholder:e.$t("common.select_default_text",[""])},{default:a(()=>[(l(!0),g(b,null,R(n.filterableColumns,o=>(l(),f(w,{key:o.key},{default:a(()=>[r(i(o.value),1)]),_:2},1024))),128))]),_:1},8,["value","placeholder"]),t(u,{style:{width:"75%"},value:e.table.searchString,"onUpdate:value":d[1]||(d[1]=o=>e.table.searchString=o),"show-search":"",onChange:e.onTableSearch,onSearch:e.onTableSearch,loading:e.table.filterLoading},null,8,["value","onChange","onSearch","loading"])]),_:1})]),_:1}),t(m,{xs:24,sm:24,md:12,lg:6,xl:6},{default:a(()=>[t(T,{value:n.filters.user_id,"onUpdate:value":d[2]||(d[2]=o=>n.filters.user_id=o),placeholder:e.$t("common.select_default_text",[e.$t("user.user")]),allowClear:!0,style:{width:"100%"},optionFilterProp:"title","show-search":"",onChange:n.setUrlData},{default:a(()=>[(l(!0),g(b,null,R(n.users,o=>(l(),f(w,{key:o.xid,title:o.name,value:o.xid},{default:a(()=>[r(i(o.name),1)]),_:2},1032,["title","value"]))),128))]),_:1},8,["value","placeholder","onChange"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),t(j,null,{default:a(()=>[t(z,{addEditType:e.addEditType,visible:e.addEditVisible,url:e.addEditUrl,onAddEditSuccess:e.addEditSuccess,onClosed:e.onCloseAddEdit,formData:e.formData,data:e.viewData,pageTitle:e.pageTitle,successMessage:e.successMessage},null,8,["addEditType","visible","url","onAddEditSuccess","onClosed","formData","data","pageTitle","successMessage"]),t(U,null,{default:a(()=>[t(m,{span:24},{default:a(()=>[ee("div",Ae,[t(H,{"row-selection":{selectedRowKeys:e.table.selectedRowKeys,onChange:e.onRowSelectChange,getCheckboxProps:o=>({disabled:!1,name:o.xid})},columns:n.columns,"row-key":o=>o.xid,"data-source":e.table.data,pagination:e.table.pagination,loading:e.table.loading,onChange:e.handleTableChange,bordered:"",size:"middle"},{bodyCell:a(({column:o,record:k})=>[o.dataIndex==="date"?(l(),g(b,{key:0},[r(i(n.formatDate(k.date)),1)],64)):c("",!0),o.dataIndex==="user_id"?(l(),f(K,{key:1,user:k.user},null,8,["user"])):c("",!0),o.dataIndex==="amount"?(l(),g(b,{key:2},[r(i(n.formatAmountCurrency(k.amount)),1)],64)):c("",!0),o.dataIndex==="action"?(l(),g(b,{key:3},[n.permsArray.includes(n.paymentType=="in"?"payment_in_edit":"payment_out_edit")||n.permsArray.includes("admin")?(l(),f(p,{key:0,type:"primary",onClick:q=>e.editItem(k),style:{"margin-left":"4px"}},{icon:a(()=>[t(L)]),_:2},1032,["onClick"])):c("",!0),n.permsArray.includes(n.paymentType=="in"?"payment_in_delete":"payment_out_delete")||n.permsArray.includes("admin")?(l(),f(p,{key:1,type:"primary",onClick:q=>e.showDeleteConfirm(k.xid),style:{"margin-left":"4px"}},{icon:a(()=>[t(v)]),_:2},1032,["onClick"])):c("",!0)],64)):c("",!0)]),summary:a(()=>[t(F,null,{default:a(()=>[t(I,{"col-span":3}),t(I,{"col-span":1},{default:a(()=>[t(B,{strong:""},{default:a(()=>[r(i(e.$t("common.total")),1)]),_:1})]),_:1}),t(I,{"col-span":1},{default:a(()=>[t(B,{strong:""},{default:a(()=>[r(i(n.formatAmountCurrency(n.totals.totalAmount)),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["row-selection","columns","row-key","data-source","pagination","loading","onChange"])])]),_:1})]),_:1})]),_:1})],64)}const ze=G(ke,[["render",we]]);export{ze as default};
