import{A as G,f as L}from"./fields-ndJJ31Zt.js";import{c as q}from"./crud-CrvpJwtV.js";import{_ as J,R as W,az as Q,aA as X,b as Y,f as Z,E as $,V as ee,a6 as ae,r as m,o as l,c as _,a,w as e,G as p,l as r,t as d,i as y,k as u,M as B,j as te,ay as ne,aB as oe,aC as le,B as se,a0 as re,q as de,aD as ie,h as me,aL as ue,aM as ce,aN as _e,J as pe,aG as ge}from"./app-Dj1Is9gq.js";import{A as fe}from"./AdminPageHeader-Bk6Suxy_.js";import{D as ye}from"./DateRangePicker-Dxt-QvAz.js";import"./apiAdmin-DXyoDADi.js";import"./UserInfo-DaXkV2_v.js";import"./fields-CSay3A5l.js";import"./SaveOutlined-CEkVke7n.js";import"./StaffAddButton-KMIKhqgC.js";import"./fields-21Wari_1.js";import"./Upload-BlHzAAld.js";import"./AddButton-X98DiJfJ.js";import"./AddEdit-DC92yLfl.js";import"./SettingOutlined-JuYX6Rqg.js";import"./AddButton-CyvOkgxH.js";import"./AddEdit-zjwyjNyM.js";import"./UploadFile-BMQyS_v_.js";import"./DateTimePicker-wyWUyDUv.js";import"./datatable-BbN5BpFL.js";import"./filter-CEEEiwR2.js";import"./index-AZVEloNj.js";const be={components:{PlusOutlined:W,EditOutlined:Q,DeleteOutlined:X,AddEdit:G,AdminPageHeader:fe,DateRangePicker:ye},setup(){const{url:t,addEditUrl:c,initData:A,columns:n,filters:v,preFetchData:S,getPreFetchData:w,hashableColumns:x}=L(),s=q(),{appSetting:E,permsArray:F,formatDate:P,selectedWarehouse:g,formatAmountCurrency:h}=Y(),C=Z({dates:[]});$(()=>{w(),s.crudUrl.value=c,s.langKey.value="expense",s.initData.value={...A},s.formData.value={...A},s.hashableColumns.value=[...x],i()});const i=()=>{s.tableUrl.value={url:t,filters:v,extraFilters:C},s.fetch({page:1})},k=ee(()=>{let f=0;return s.table.data.forEach(D=>{f+=D.amount}),{totalAmount:f}});return ae(g,(f,D)=>{i()}),{columns:n,appSetting:E,formatDate:P,...s,filters:v,extraFilters:C,preFetchData:S,reFetchDatatable:i,permsArray:F,formatAmountCurrency:h,totals:k}}},he={class:"table-responsive"};function Ce(t,c,A,n,v,S){const w=ne,x=m("router-link"),s=oe,E=le,F=m("AdminPageHeader"),P=m("PlusOutlined"),g=se,h=m("DeleteOutlined"),C=re,i=de,k=ge,f=ie,D=m("DateRangePicker"),T=me,I=m("admin-page-filters"),U=m("AddEdit"),N=m("EditOutlined"),O=ue,R=ce,K=_e,M=pe,z=m("admin-page-table-content");return l(),_(p,null,[a(F,null,{header:e(()=>[a(w,{title:t.$t("menu.expenses"),class:"p-0"},null,8,["title"])]),breadcrumb:e(()=>[a(E,{separator:"-",style:{"font-size":"12px"}},{default:e(()=>[a(s,null,{default:e(()=>[a(x,{to:{name:"admin.dashboard.index"}},{default:e(()=>[r(d(t.$t("menu.dashboard")),1)]),_:1},8,["to"])]),_:1}),a(s,null,{default:e(()=>[r(d(t.$t("menu.expense_manager")),1)]),_:1}),a(s,null,{default:e(()=>[r(d(t.$t("menu.expenses")),1)]),_:1})]),_:1})]),_:1}),a(I,null,{default:e(()=>[a(T,{gutter:[16,16]},{default:e(()=>[a(i,{xs:24,sm:24,md:12,lg:10,xl:10},{default:e(()=>[a(C,null,{default:e(()=>[n.permsArray.includes("expenses_create")||n.permsArray.includes("admin")?(l(),y(g,{key:0,type:"primary",onClick:t.addItem},{default:e(()=>[a(P),r(" "+d(t.$t("expense.add")),1)]),_:1},8,["onClick"])):u("",!0),t.table.selectedRowKeys.length>0&&(n.permsArray.includes("expenses_delete")||n.permsArray.includes("admin"))?(l(),y(g,{key:1,type:"primary",onClick:t.showSelectedDeleteConfirm,danger:""},{icon:e(()=>[a(h)]),default:e(()=>[r(" "+d(t.$t("common.delete")),1)]),_:1},8,["onClick"])):u("",!0)]),_:1})]),_:1}),a(i,{xs:24,sm:24,md:12,lg:14,xl:14},{default:e(()=>[a(T,{gutter:[16,16],justify:"end"},{default:e(()=>[a(i,{xs:24,sm:24,md:8,lg:6,xl:6},{default:e(()=>[a(f,{value:n.filters.expense_category_id,"onUpdate:value":c[0]||(c[0]=o=>n.filters.expense_category_id=o),"show-search":"",style:{width:"100%"},placeholder:t.$t("common.select_default_text",[t.$t("expense.expense_category")]),onChange:n.reFetchDatatable,allowClear:!0,optionFilterProp:"label"},{default:e(()=>[(l(!0),_(p,null,B(n.preFetchData.expenseCategories,o=>(l(),y(k,{key:o.xid,value:o.xid,label:o.name},{default:e(()=>[r(d(o.name),1)]),_:2},1032,["value","label"]))),128))]),_:1},8,["value","placeholder","onChange"])]),_:1}),a(i,{xs:24,sm:24,md:8,lg:6,xl:6},{default:e(()=>[a(f,{value:n.filters.user_id,"onUpdate:value":c[1]||(c[1]=o=>n.filters.user_id=o),"show-search":"",style:{width:"100%"},placeholder:t.$t("common.select_default_text",[t.$t("expense.user")]),onChange:n.reFetchDatatable,allowClear:!0,optionFilterProp:"label"},{default:e(()=>[(l(!0),_(p,null,B(n.preFetchData.staffMembers,o=>(l(),y(k,{key:o.xid,value:o.xid,label:o.name},{default:e(()=>[r(d(o.name),1)]),_:2},1032,["value","label"]))),128))]),_:1},8,["value","placeholder","onChange"])]),_:1}),a(i,{xs:24,sm:24,md:8,lg:8,xl:8},{default:e(()=>[a(D,{onDateTimeChanged:c[2]||(c[2]=o=>{n.extraFilters.dates=o,n.reFetchDatatable()})})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),a(z,null,{default:e(()=>[a(U,{addEditType:t.addEditType,visible:t.addEditVisible,url:t.addEditUrl,onAddEditSuccess:t.addEditSuccess,onClosed:t.onCloseAddEdit,formData:t.formData,data:t.viewData,pageTitle:t.pageTitle,successMessage:t.successMessage},null,8,["addEditType","visible","url","onAddEditSuccess","onClosed","formData","data","pageTitle","successMessage"]),a(T,{class:"mt-20"},{default:e(()=>[a(i,{span:24},{default:e(()=>[te("div",he,[a(M,{"row-selection":{selectedRowKeys:t.table.selectedRowKeys,onChange:t.onRowSelectChange,getCheckboxProps:o=>({disabled:!1,name:o.xid})},columns:n.columns,"row-key":o=>o.xid,"data-source":t.table.data,pagination:t.table.pagination,loading:t.table.loading,onChange:t.handleTableChange,bordered:"",size:"middle"},{bodyCell:e(({column:o,text:H,record:b})=>{var V;return[o.dataIndex==="expense_category_id"?(l(),_(p,{key:0},[r(d(b.expense_category.name),1)],64)):u("",!0),o.dataIndex==="user_id"?(l(),_(p,{key:1},[r(d((V=b.user)==null?void 0:V.name),1)],64)):u("",!0),o.dataIndex==="amount"?(l(),_(p,{key:2},[r(d(n.formatAmountCurrency(H)),1)],64)):u("",!0),o.dataIndex==="date"?(l(),_(p,{key:3},[r(d(n.formatDate(b.date)),1)],64)):u("",!0),o.dataIndex==="action"?(l(),_(p,{key:4},[n.permsArray.includes("expenses_edit")||n.permsArray.includes("admin")?(l(),y(g,{key:0,type:"primary",onClick:j=>t.editItem(b),style:{"margin-left":"4px"}},{icon:e(()=>[a(N)]),_:2},1032,["onClick"])):u("",!0),n.permsArray.includes("expenses_delete")||n.permsArray.includes("admin")?(l(),y(g,{key:1,type:"primary",onClick:j=>t.showDeleteConfirm(b.xid),style:{"margin-left":"4px"}},{icon:e(()=>[a(h)]),_:2},1032,["onClick"])):u("",!0)],64)):u("",!0)]}),summary:e(()=>[a(K,null,{default:e(()=>[a(O,{"col-span":1}),a(O,{"col-span":1},{default:e(()=>[a(R,{strong:""},{default:e(()=>[r(d(t.$t("common.total")),1)]),_:1})]),_:1}),a(O,{"col-span":1},{default:e(()=>[a(R,{strong:""},{default:e(()=>[r(d(n.formatAmountCurrency(n.totals.totalAmount)),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["row-selection","columns","row-key","data-source","pagination","loading","onChange"])])]),_:1})]),_:1})]),_:1})],64)}const je=J(be,[["render",Ce]]);export{je as default};
