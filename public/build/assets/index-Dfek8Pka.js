import{_ as V,d as z,b as I,E as B,a6 as T,V as F,o as p,i as A,w as a,a as t,j as P,l as o,t as r,k,c as b,G as h,a1 as G,aR as L,aM as J,aL as O,H as Q,aN as W,J as K,q as E,h as H,g as R,f as N,e as X,cg as Y,r as x,M as Z,ay as D,aB as ee,aC as te,aQ as ae,aD as ne,aG as oe}from"./app-CXajSIJN.js";import{d as M}from"./datatable-BwALyFLJ.js";import{A as re}from"./AdminPageHeader-CLpphX8z.js";import{U as se}from"./UserInfo-R4lQF8wf.js";import{c as le,E as de}from"./ExportTable-Dyh8nfCK.js";import{P as ie}from"./PaymentStatus-BKtwcAN9.js";import"./filter-Buzvu9Uk.js";import"./index-CDZHKPbx.js";import"./PrinterOutlined-oLRqAQtu.js";import"./fields-ldUUnm_E.js";const _e=z({props:{category_id:null,brand_id:null},components:{UserInfo:se,PaymentStatus:ie},setup(e){const{summaryColumns:c,hashableColumns:v}=le(),{formatDateTime:d,formatAmountCurrency:C,selectedWarehouse:$}=I(),i=M();B(()=>{f(e)});const f=n=>{const l={};n.category_id&&n.category_id!=null&&(l.category_id=n.category_id),n.brand_id&&n.brand_id!=null&&(l.brand_id=n.brand_id),i.tableUrl.value={url:"products?fields=id,xid,name,,item_code,image,image_url,category_id,x_category_id,category{id,xid,name},brand_id,x_brand_id,brand{id,xid,name},unit_id,x_unit_id,unit{id,xid,name,short_name},details{stock_quantitiy_alert,opening_stock,opening_stock_date,wholesale_price,wholesale_quantity,mrp,purchase_price,sales_price,tax_id,x_tax_id,purchase_tax_type,sales_tax_type,current_stock,warehouse_id,x_warehouse_id,status},details:tax{id,xid,name,rate}",filters:l},i.hashable.value=[...v],i.table.sorter={field:"name",order:"asc"},i.exportDetails.value={allowExport:!0,exportType:"stock_summary_reports"},i.fetch({page:1})};T(e,(n,l)=>{f(n)}),T($,(n,l)=>{f(e)});const u=F(()=>{let n=0,l=0,g=0;return i.table.data.forEach(_=>{n+=_.details.current_stock,l+=_.details.current_stock*_.details.sales_price,g+=_.details.current_stock*_.details.purchase_price}),{totalCurrentStock:n,totalSalesPrice:l,totalPurchasePrice:g}});return{summaryColumns:c,...i,formatDateTime:d,formatAmountCurrency:C,totals:u}}}),ue={class:"table-responsive"},ce=P("br",null,null,-1),me=P("br",null,null,-1);function pe(e,c,v,d,C,$){const i=G,f=L,u=J,n=O,l=Q,g=W,_=K,w=E,S=H;return p(),A(S,null,{default:a(()=>[t(w,{span:24},{default:a(()=>[P("div",ue,[t(_,{columns:e.summaryColumns,"row-key":m=>m.xid,"data-source":e.table.data,pagination:e.table.pagination,loading:e.table.loading,onChange:e.handleTableChange,id:"stock-summary-reports-table",bordered:"",size:"middle"},{bodyCell:a(({column:m,record:s})=>[m.dataIndex==="name"?(p(),A(f,{key:0},{default:a(()=>[t(i,{shape:"square",src:s.image_url},null,8,["src"]),o(" "+r(s.name),1)]),_:2},1024)):k("",!0),m.dataIndex==="category_id"?(p(),b(h,{key:1},[o(r(s.category.name),1)],64)):k("",!0),m.dataIndex==="brand_id"?(p(),b(h,{key:2},[o(r(s.brand&&s.brand.xid?s.brand.name:"-"),1)],64)):k("",!0),m.dataIndex==="sales_price"?(p(),b(h,{key:3},[o(r(e.formatAmountCurrency(s.details.sales_price)),1)],64)):k("",!0),m.dataIndex==="purchase_price"?(p(),b(h,{key:4},[o(r(e.formatAmountCurrency(s.details.purchase_price)),1)],64)):k("",!0),m.dataIndex==="current_stock"?(p(),b(h,{key:5},[o(r(`${s.details.current_stock} ${s.unit.short_name}`),1)],64)):k("",!0),m.dataIndex==="stock_value"?(p(),b(h,{key:6},[o(r(e.$t("product.by_purchase"))+" : ",1),t(u,{strong:""},{default:a(()=>[o(r(e.formatAmountCurrency(s.details.current_stock*s.details.purchase_price)),1)]),_:2},1024),ce,o(" "+r(e.$t("product.by_sales"))+" : ",1),t(u,{strong:""},{default:a(()=>[o(r(e.formatAmountCurrency(s.details.current_stock*s.details.sales_price)),1)]),_:2},1024)],64)):k("",!0)]),summary:a(()=>[t(g,null,{default:a(()=>[t(n,{"col-span":5}),t(n,{"col-span":1},{default:a(()=>[t(u,{strong:""},{default:a(()=>[o(r(e.$t("common.total")),1)]),_:1})]),_:1}),t(n,{"col-span":1},{default:a(()=>[t(u,{strong:""},{default:a(()=>[t(l,null,{default:a(()=>[o(r(e.totals.totalCurrentStock),1)]),_:1})]),_:1})]),_:1}),t(n,{"col-span":1},{default:a(()=>[o(r(e.$t("product.by_purchase"))+" : ",1),t(u,{strong:""},{default:a(()=>[t(l,null,{default:a(()=>[o(r(e.formatAmountCurrency(e.totals.totalPurchasePrice)),1)]),_:1})]),_:1}),me,o(" "+r(e.$t("product.by_sales"))+" : ",1),t(u,{strong:""},{default:a(()=>[t(l,null,{default:a(()=>[o(r(e.formatAmountCurrency(e.totals.totalSalesPrice)),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["columns","row-key","data-source","pagination","loading","onChange"])])]),_:1})]),_:1})}const fe=V(_e,[["render",pe]]),ge={components:{AdminPageHeader:re,StockSummary:fe,ExprotTable:de},setup(){const e=M(),{permsArray:c,getRecursiveCategories:v,filterTreeNode:d,willSubscriptionModuleVisible:C}=I(),$=R({category_id:void 0,brand_id:void 0}),i=N([]),f=N([]),u=X();Y(()=>{(!(c.value.includes("products_view")||c.value.includes("admin"))||!C("reports"))&&u.push("admin.dashboard.index")}),B(()=>{n()});const n=()=>{const l=axiosAdmin.get("categories?limit=10000"),g=axiosAdmin.get("brands?limit=10000");Promise.all([l,g]).then(([_,w])=>{i.value=v(_),f.value=w.data})};return{...e,filters:$,categories:i,brands:f,permsArray:c,filterTreeNode:d}}};function ye(e,c,v,d,C,$){const i=x("ExprotTable"),f=D,u=x("router-link"),n=ee,l=te,g=x("AdminPageHeader"),_=E,w=ae,S=oe,m=ne,s=H,U=x("admin-page-filters"),q=x("StockSummary"),j=x("admin-page-table-content");return p(),b(h,null,[t(g,null,{header:a(()=>[t(f,{title:e.$t("menu.stock_summary"),class:"p-0"},{extra:a(()=>[t(i,{exportType:"stock_summary_reports",tableName:"stock-summary-reports-table",title:`${e.$t("menu.stock_summary")} ${e.$t("menu.reports")}`},null,8,["title"])]),_:1},8,["title"])]),breadcrumb:a(()=>[t(l,{separator:"-",style:{"font-size":"12px"}},{default:a(()=>[t(n,null,{default:a(()=>[t(u,{to:{name:"admin.dashboard.index"}},{default:a(()=>[o(r(e.$t("menu.dashboard")),1)]),_:1},8,["to"])]),_:1}),t(n,null,{default:a(()=>[o(r(e.$t("menu.reports")),1)]),_:1}),t(n,null,{default:a(()=>[o(r(e.$t("menu.stock_summary")),1)]),_:1})]),_:1})]),_:1}),t(U,null,{default:a(()=>[t(s,{gutter:[16,16]},{default:a(()=>[t(_,{xs:24,sm:24,md:12,lg:10,xl:10}),t(_,{xs:24,sm:24,md:12,lg:14,xl:14},{default:a(()=>[t(s,{gutter:[16,16],justify:"end"},{default:a(()=>[t(_,{xs:24,sm:24,md:8,lg:6,xl:6},{default:a(()=>[t(w,{value:d.filters.category_id,"onUpdate:value":c[0]||(c[0]=y=>d.filters.category_id=y),"show-search":"",style:{width:"100%"},"dropdown-style":{maxHeight:"250px",overflow:"auto"},placeholder:e.$t("common.select_default_text",[e.$t("category.category")]),"tree-data":d.categories,"allow-clear":"","tree-default-expand-all":"",filterTreeNode:d.filterTreeNode},null,8,["value","placeholder","tree-data","filterTreeNode"])]),_:1}),t(_,{xs:24,sm:24,md:8,lg:6,xl:6},{default:a(()=>[t(m,{value:d.filters.brand_id,"onUpdate:value":c[1]||(c[1]=y=>d.filters.brand_id=y),placeholder:e.$t("common.select_default_text",[e.$t("product.brand")]),allowClear:!0,style:{width:"100%"},optionFilterProp:"title","show-search":""},{default:a(()=>[(p(!0),b(h,null,Z(d.brands,y=>(p(),A(S,{key:y.xid,title:y.name,value:y.xid},{default:a(()=>[o(r(y.name),1)]),_:2},1032,["title","value"]))),128))]),_:1},8,["value","placeholder"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),t(j,null,{default:a(()=>[t(q,{category_id:d.filters.category_id,brand_id:d.filters.brand_id},null,8,["category_id","brand_id"])]),_:1})],64)}const Pe=V(ge,[["render",ye]]);export{Pe as default};
