import{_ as U,b as j,f as C,e as z,cg as G,E as L,V as $,a6 as q,r as f,o as d,c as p,a as e,w as a,G as c,l,t as s,M as F,j as J,k as D,ay as O,aB as W,aC as K,q as Q,aD as X,h as Y,aL as Z,aM as ee,aN as ae,J as te,i as M,aG as ne}from"./app-CjpTPDuB.js";import{P as oe}from"./ProductSearchInput-OyWJrXzr.js";import{d as le}from"./datatable-C20uS0H9.js";import{E as se,g as re}from"./ExportTable-BBUnzkG8.js";import{A as de}from"./AdminPageHeader-iVNVl6hx.js";import{D as ue}from"./DateRangePicker-CjZ8AmvN.js";import"./filter-vfhrW-uH.js";import"./PrinterOutlined-W5UVr-8I.js";import"./fields-C8CpP3AP.js";import"./index-C-7mFwhh.js";const me={components:{ProductSearchInput:oe,AdminPageHeader:de,ExprotTable:se,DateRangePicker:ue},setup(){const{permsArray:n,selectedWarehouse:u,formatAmountCurrency:E,formatDate:o,willSubscriptionModuleVisible:B}=j(),{url:I,expenseColumns:P,expenseHashableColumns:T}=re(),A=C(void 0),g=z(),m=le(),v=C({expense_category_id:void 0,user_id:void 0}),r=C([]),b=C([]),x=C({dates:[]});G(()=>{(!(n.value.includes("expenses_view")||n.value.includes("admin"))||!B("reports"))&&g.push("admin.dashboard.index")}),L(()=>{const i=axiosAdmin.get("expense-categories?limit=10000"),_=axiosAdmin.get("users?limit=10000");Promise.all([i,_]).then(([w,V])=>{r.value=w.data,b.value=V.data}),h()});const h=()=>{m.tableUrl.value={url:I,filters:v,extraFilters:x},m.hashable.value=[...T],m.exportDetails.value={allowExport:!0,exportType:"expense_reports"},m.fetch({page:1})},y=$(()=>{let i=0;return m.table.data.forEach(_=>{i+=_.amount}),{totalAmount:i}});return q(u,(i,_)=>{h()}),{expenseColumns:P,...m,searchProductId:A,getTableData:h,permsArray:n,filters:v,extraFilters:x,expenseCategories:r,staffMembers:b,formatAmountCurrency:E,formatDate:o,totals:y}}},_e={class:"table-responsive"};function ie(n,u,E,o,B,I){const P=f("ExprotTable"),T=O,A=f("router-link"),g=W,m=K,v=f("AdminPageHeader"),r=Q,b=ne,x=X,h=f("DateRangePicker"),y=Y,i=f("admin-page-filters"),_=Z,w=ee,V=ae,R=te,H=f("admin-page-table-content");return d(),p(c,null,[e(v,null,{header:a(()=>[e(T,{title:n.$t("menu.expense_reports"),class:"p-0"},{extra:a(()=>[e(P,{exportType:"expense_reports",tableName:"expense-reports-table",title:`${n.$t("menu.expenses")} ${n.$t("menu.reports")}`},null,8,["title"])]),_:1},8,["title"])]),breadcrumb:a(()=>[e(m,{separator:"-",style:{"font-size":"12px"}},{default:a(()=>[e(g,null,{default:a(()=>[e(A,{to:{name:"admin.dashboard.index"}},{default:a(()=>[l(s(n.$t("menu.dashboard")),1)]),_:1},8,["to"])]),_:1}),e(g,null,{default:a(()=>[l(s(n.$t("menu.reports")),1)]),_:1}),e(g,null,{default:a(()=>[l(s(n.$t("menu.expense_reports")),1)]),_:1})]),_:1})]),_:1}),e(i,null,{default:a(()=>[e(y,{gutter:[16,16]},{default:a(()=>[e(r,{xs:24,sm:24,md:12,lg:10,xl:10}),e(r,{xs:24,sm:24,md:12,lg:14,xl:14},{default:a(()=>[e(y,{gutter:[16,16],justify:"end"},{default:a(()=>[e(r,{xs:24,sm:24,md:8,lg:6,xl:6},{default:a(()=>[e(x,{value:o.filters.expense_category_id,"onUpdate:value":u[0]||(u[0]=t=>o.filters.expense_category_id=t),"show-search":"",style:{width:"100%"},placeholder:n.$t("common.select_default_text",[n.$t("expense.expense_category")]),onChange:o.getTableData,allowClear:!0,optionFilterProp:"label"},{default:a(()=>[(d(!0),p(c,null,F(o.expenseCategories,t=>(d(),M(b,{key:t.xid,value:t.xid,label:t.name},{default:a(()=>[l(s(t.name),1)]),_:2},1032,["value","label"]))),128))]),_:1},8,["value","placeholder","onChange"])]),_:1}),e(r,{xs:24,sm:24,md:8,lg:6,xl:6},{default:a(()=>[e(x,{value:o.filters.user_id,"onUpdate:value":u[1]||(u[1]=t=>o.filters.user_id=t),"show-search":"",style:{width:"100%"},placeholder:n.$t("common.select_default_text",[n.$t("expense.user")]),onChange:o.getTableData,allowClear:!0,optionFilterProp:"label"},{default:a(()=>[(d(!0),p(c,null,F(o.staffMembers,t=>(d(),M(b,{key:t.xid,value:t.xid,label:t.name},{default:a(()=>[l(s(t.name),1)]),_:2},1032,["value","label"]))),128))]),_:1},8,["value","placeholder","onChange"])]),_:1}),e(r,{xs:24,sm:24,md:8,lg:8,xl:8},{default:a(()=>[e(h,{onDateTimeChanged:u[2]||(u[2]=t=>{o.extraFilters.dates=t,o.getTableData()})})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(H,null,{default:a(()=>[e(y,null,{default:a(()=>[e(r,{span:24},{default:a(()=>[J("div",_e,[e(R,{columns:o.expenseColumns,"row-key":t=>t.xid,"data-source":n.table.data,pagination:n.table.pagination,loading:n.table.loading,onChange:n.handleTableChange,id:"expense-reports-table",bordered:"",size:"middle"},{bodyCell:a(({column:t,record:k})=>{var N,S;return[t.dataIndex==="expense_category_id"?(d(),p(c,{key:0},[l(s((N=k.expense_category)==null?void 0:N.name),1)],64)):D("",!0),t.dataIndex==="amount"?(d(),p(c,{key:1},[l(s(o.formatAmountCurrency(k.amount)),1)],64)):D("",!0),t.dataIndex==="date"?(d(),p(c,{key:2},[l(s(o.formatDate(k.date)),1)],64)):D("",!0),t.dataIndex==="user_id"?(d(),p(c,{key:3},[l(s((S=k.user)==null?void 0:S.name),1)],64)):D("",!0)]}),summary:a(()=>[e(V,null,{default:a(()=>[e(_,{"col-span":2}),e(_,{"col-span":1},{default:a(()=>[e(w,{strong:""},{default:a(()=>[l(s(n.$t("common.total")),1)]),_:1})]),_:1}),e(_,{"col-span":1},{default:a(()=>[e(w,{strong:""},{default:a(()=>[l(s(o.formatAmountCurrency(o.totals.totalAmount)),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["columns","row-key","data-source","pagination","loading","onChange"])])]),_:1})]),_:1})]),_:1})],64)}const we=U(me,[["render",ie]]);export{we as default};
