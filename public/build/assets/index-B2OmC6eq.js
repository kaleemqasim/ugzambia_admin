import{_ as A,d as M,b as V,E as N,V as R,a6 as T,o as b,i as $,w as t,a as e,j as U,l as _,t as c,k as x,c as v,G as w,a1 as j,aR as q,aL as F,aM as G,aN as J,J as L,q as B,h as E,e as Q,g as W,f as K,cg as O,r as g,ay as X,aB as Y,aC as Z,aQ as ee}from"./app-CDr1bG5H.js";import{d as I}from"./datatable-BCwlZ-YI.js";import{A as te}from"./AdminPageHeader-C58ahpJ5.js";import{U as ae}from"./UserInfo-aR4s-S34.js";import{e as oe,E as ne}from"./ExportTable-DP7NNhDd.js";import{P as re}from"./PaymentStatus-BI5M-ZBb.js";import{P as se}from"./ProductSearchInput-CMqccW3l.js";import{D as le}from"./DateRangePicker-DLJ2COWd.js";import"./filter-XrGgxYsV.js";import"./index-DQuVqeGd.js";import"./PrinterOutlined-ClKbFR4o.js";import"./fields-COYscS0_.js";const de=M({props:{product_id:null,category_id:null,dates:{default:[],type:null}},components:{UserInfo:ae,PaymentStatus:re},setup(a){const{columns:s,hashableColumns:h,defaultSorter:r}=oe(),{formatDateTime:P,formatAmountCurrency:S,selectedWarehouse:y}=V(),o=I();N(()=>{o.table.default_sorter=r,o.table.pagination={pageSize:1e4,showSizeChanger:!1},l(a)});const l=n=>{const u={};n.product_id&&n.product_id!=null&&(u.product_id=n.product_id),o.tableUrl.value={url:"order-items?fields=id",filters:u,extraFilters:{product_sales_summary:!0,dates:n.dates,category_id:n.category_id}},o.hashable.value=[...h],o.table.sorter=r,o.exportDetails.value={allowExport:!0,exportType:"product_sales_summary_reports"},o.fetch({page:1})},d=R(()=>{let n=0,u=0,i=0;return o.table.data.forEach(p=>{n+=p.product.details.purchase_price*p.unit_sold,u+=p.total_sales_price,i+=p.unit_sold}),{totalPurchasePrice:n,totalSalesPrice:u,unitSold:i}});return T(a,(n,u)=>{l(n)}),T(y,(n,u)=>{l(a)}),{columns:s,...o,formatDateTime:P,formatAmountCurrency:S,totals:d}}}),ue={class:"table-responsive"};function _e(a,s,h,r,P,S){const y=j,o=q,l=F,d=G,n=J,u=L,i=B,p=E;return b(),$(p,null,{default:t(()=>[e(i,{span:24},{default:t(()=>[U("div",ue,[e(u,{columns:a.columns,"row-key":f=>f.xid,"data-source":a.table.data,pagination:a.table.pagination,loading:a.table.loading,onChange:a.handleTableChange,id:"product-sales-summary-reports-table",bordered:"",size:"middle"},{bodyCell:t(({column:f,record:m})=>[f.dataIndex==="name"?(b(),$(o,{key:0},{default:t(()=>[e(y,{shape:"square",src:m.product.image_url},null,8,["src"]),_(" "+c(m.product.name),1)]),_:2},1024)):x("",!0),f.dataIndex==="unit_sold"?(b(),v(w,{key:1},[_(c(`${m.unit_sold} ${m.product.unit.short_name}`),1)],64)):x("",!0),f.dataIndex==="total_purchase_price"?(b(),v(w,{key:2},[_(c(a.formatAmountCurrency(m.unit_sold*m.product.details.purchase_price)),1)],64)):x("",!0),f.dataIndex==="total_sales_price"?(b(),v(w,{key:3},[_(c(a.formatAmountCurrency(m.total_sales_price)),1)],64)):x("",!0)]),summary:t(()=>[e(n,null,{default:t(()=>[e(l,{"col-span":1}),e(l,{"col-span":1},{default:t(()=>[e(d,{strong:""},{default:t(()=>[_(c(a.$t("common.total")),1)]),_:1})]),_:1}),e(l,{"col-span":1},{default:t(()=>[e(d,{strong:""},{default:t(()=>[_(c(a.totals.unitSold),1)]),_:1})]),_:1}),e(l,{"col-span":1},{default:t(()=>[e(d,{strong:""},{default:t(()=>[_(c(a.formatAmountCurrency(a.totals.totalPurchasePrice)),1)]),_:1})]),_:1}),e(l,{"col-span":1},{default:t(()=>[e(d,{strong:""},{default:t(()=>[_(c(a.formatAmountCurrency(a.totals.totalSalesPrice)),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["columns","row-key","data-source","pagination","loading","onChange"])])]),_:1})]),_:1})}const ce=A(de,[["render",_e]]),ie={components:{AdminPageHeader:te,ProductSaleSummary:ce,ProductSearchInput:se,DateRangePicker:le,ExprotTable:ne},setup(){const a=I(),{permsArray:s,getRecursiveCategories:h,filterTreeNode:r,willSubscriptionModuleVisible:P}=V(),S=Q(),y=W({product_id:void 0,category_id:void 0,dates:[]}),o=K([]);return O(()=>{(!(s.value.includes("products_view")||s.value.includes("admin"))||!P("reports"))&&S.push("admin.dashboard.index")}),N(()=>{const l=axiosAdmin.get("categories?limit=10000");Promise.all([l]).then(([d])=>{o.value=h(d)})}),{...a,permsArray:s,filters:y,filterTreeNode:r,categories:o}}};function me(a,s,h,r,P,S){const y=g("ExprotTable"),o=X,l=g("router-link"),d=Y,n=Z,u=g("AdminPageHeader"),i=B,p=g("ProductSearchInput"),f=ee,m=g("DateRangePicker"),k=E,z=g("admin-page-filters"),D=g("ProductSaleSummary"),H=g("admin-page-table-content");return b(),v(w,null,[e(u,null,{header:t(()=>[e(o,{title:a.$t("menu.product_sales_summary"),class:"p-0"},{extra:t(()=>[e(y,{exportType:"product_sales_summary_reports",tableName:"product-sales-summary-reports-table",title:`${a.$t("menu.product_sales_summary")} ${a.$t("menu.reports")}`},null,8,["title"])]),_:1},8,["title"])]),breadcrumb:t(()=>[e(n,{separator:"-",style:{"font-size":"12px"}},{default:t(()=>[e(d,null,{default:t(()=>[e(l,{to:{name:"admin.dashboard.index"}},{default:t(()=>[_(c(a.$t("menu.dashboard")),1)]),_:1},8,["to"])]),_:1}),e(d,null,{default:t(()=>[_(c(a.$t("menu.reports")),1)]),_:1}),e(d,null,{default:t(()=>[_(c(a.$t("menu.product_sales_summary")),1)]),_:1})]),_:1})]),_:1}),e(z,null,{default:t(()=>[e(k,{gutter:[16,16]},{default:t(()=>[e(i,{xs:24,sm:24,md:12,lg:10,xl:10}),e(i,{xs:24,sm:24,md:12,lg:14,xl:14},{default:t(()=>[e(k,{gutter:[16,16],justify:"end"},{default:t(()=>[e(i,{xs:24,sm:24,md:12,lg:8,xl:6},{default:t(()=>[e(p,{onValueChanged:s[0]||(s[0]=C=>{r.filters.product_id=C})})]),_:1}),e(i,{xs:24,sm:24,md:8,lg:6,xl:6},{default:t(()=>[e(f,{value:r.filters.category_id,"onUpdate:value":s[1]||(s[1]=C=>r.filters.category_id=C),"show-search":"",style:{width:"100%"},"dropdown-style":{maxHeight:"250px",overflow:"auto"},placeholder:a.$t("common.select_default_text",[a.$t("category.category")]),"tree-data":r.categories,"allow-clear":"","tree-default-expand-all":"",filterTreeNode:r.filterTreeNode},null,8,["value","placeholder","tree-data","filterTreeNode"])]),_:1}),e(i,{xs:24,sm:24,md:10,lg:6,xl:6},{default:t(()=>[e(m,{onDateTimeChanged:s[2]||(s[2]=C=>{r.filters.dates=C})})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(H,null,{default:t(()=>[e(D,{product_id:r.filters.product_id,dates:r.filters.dates,category_id:r.filters.category_id},null,8,["product_id","dates","category_id"])]),_:1})],64)}const ke=A(ie,[["render",me]]);export{ke as default};
