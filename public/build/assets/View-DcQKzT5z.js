import{_ as C,d as k,b as I,r as g,o as s,i as u,w as a,a as n,l as o,t as r,c as h,k as i,H as V,Y as D,E as O,a6 as K,V as N,G as U,aL as S,aM as W,aN as E,J as F,q as B,h as T,f as H,an as M,ao as L,j,al as q,aO as G,aP as J,ap as P}from"./app-0t5sL0S-.js";import{a as R,A as Y}from"./ArrowUpOutlined-BWhVfHkn.js";import{d as z}from"./datatable-Dtwj48pe.js";import{U as Q}from"./UserInfo-q80PEcrT.js";const X=k({props:["amount"],components:{ArrowDownOutlined:R,ArrowUpOutlined:Y},setup(){const{formatAmountCurrency:e}=I();return{formatAmountCurrency:e}}}),Z={key:0};function x(e,d,c,y,$,p){const _=g("ArrowUpOutlined"),l=V,t=g("ArrowDownOutlined");return e.amount<0?(s(),u(l,{key:0,title:e.$t("payments.you_will_pay")},{default:a(()=>[n(_,{style:{color:"red"}}),o(" "+r(e.formatAmountCurrency(Math.abs(e.amount))),1)]),_:1},8,["title"])):(s(),u(l,{key:1,title:e.$t("payments.you_will_receive")},{default:a(()=>[e.amount>0?(s(),h("span",Z,[n(t,{style:{color:"green"}})])):i("",!0),o(" "+r(e.formatAmountCurrency(e.amount)),1)]),_:1},8,["title"]))}const ee=C(X,[["render",x]]),te=()=>{const{t:e}=D(),d=["user_id"],c=[{key:"name",value:e("user.name")}],y=[{title:e("payments.date"),dataIndex:"date"},{title:e("payments.transaction_number"),dataIndex:"transaction_number"},{title:e("payments.payment_type"),dataIndex:"payment_type"},{title:e("payments.user"),dataIndex:"user_id"},{title:e("payments.amount"),dataIndex:"amount"}];return{transactionsFilterableColumns:c,transactionsColumns:y,transactionsHashableColumns:d}},ae=k({props:{user_id:null,result_type:{default:"all",type:String}},components:{UserInfo:Q},setup(e){const{transactionsColumns:d,transactionsHashableColumns:c}=te(),{formatDate:y,formatAmountCurrency:$}=I(),p=z();O(()=>{_(e)});const _=t=>{const m={},b={result_type:t.result_type};t.user_id&&t.user_id!=null&&(b.user_id=t.user_id),p.tableUrl.value={url:"warehouse-history?fields=id,xid,date,type,amount,transaction_number,user_id,x_user_id,user{id,xid,name,profile_image,profile_image_url,user_type}",filters:m,extraFilters:b},p.hashable.value=[...c],p.table.sorter={field:"date",order:"asc"},p.fetch({page:1})};K(e,(t,m)=>{_(t)});const l=N(()=>{let t=0;return p.table.data.forEach(m=>{t+=m.amount}),{totalAmount:t}});return{transactionsColumns:d,...p,totals:l,formatDate:y,formatAmountCurrency:$}}}),ne={key:0,class:"table-responsive"};function se(e,d,c,y,$,p){const _=g("UserInfo"),l=S,t=W,m=E,b=F,v=B,A=T;return s(),u(A,null,{default:a(()=>[n(v,{span:24},{default:a(()=>[e.table.loading?i("",!0):(s(),h("div",ne,[n(b,{columns:e.transactionsColumns,"row-key":f=>f.xid,"data-source":e.table.data,pagination:e.table.pagination,loading:e.table.loading,onChange:e.handleTableChange},{bodyCell:a(({column:f,record:w})=>[f.dataIndex==="date"?(s(),h(U,{key:0},[o(r(e.formatDate(w.date)),1)],64)):i("",!0),f.dataIndex==="payment_type"?(s(),h(U,{key:1},[o(r(w.type),1)],64)):i("",!0),f.dataIndex==="user_id"?(s(),u(_,{key:2,user:w.user,showLink:!1},null,8,["user"])):i("",!0),f.dataIndex==="amount"?(s(),h(U,{key:3},[o(r(e.formatAmountCurrency(w.amount)),1)],64)):i("",!0)]),summary:a(()=>[n(m,null,{default:a(()=>[n(l,{"col-span":3}),n(l,{"col-span":1},{default:a(()=>[n(t,{strong:""},{default:a(()=>[o(r(e.$t("common.total")),1)]),_:1})]),_:1}),n(l,{"col-span":1},{default:a(()=>[n(t,{strong:""},{default:a(()=>[o(r(e.formatAmountCurrency(e.totals.totalAmount)),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["columns","row-key","data-source","pagination","loading","onChange"])]))]),_:1})]),_:1})}const oe=C(ae,[["render",se]]),re=k({props:["user"],components:{Transactions:oe},setup(){return{activeKey:H("transactions")}}});function le(e,d,c,y,$,p){const _=g("Transactions"),l=M,t=L;return s(),u(t,{activeKey:e.activeKey,"onUpdate:activeKey":d[0]||(d[0]=m=>e.activeKey=m)},{default:a(()=>[n(l,{key:"transactions",tab:e.$t("payments.transactions")},{default:a(()=>[n(_,{user_id:e.user.xid,result_type:e.user.user_type=="staff_members"?"staff_member":"customer_supplier"},null,8,["user_id","result_type"])]),_:1},8,["tab"])]),_:1},8,["activeKey"])}const ue=C(re,[["render",le]]),ie=k({props:["user","visible"],emits:["closed"],components:{UserBalance:ee,UserDetails:ue},setup(e,{emit:d}){const{formatAmountCurrency:c}=I();return D(),{formatAmountCurrency:c,onClose:()=>{d("closed")},drawerWidth:window.innerWidth<=991?"90%":"60%"}}}),de={class:"user-details"};function me(e,d,c,y,$,p){const _=q,l=B,t=G,m=g("UserBalance"),b=J,v=T,A=g("UserDetails"),f=P;return s(),u(f,{title:e.user.name,width:e.drawerWidth,open:e.visible,"body-style":{paddingBottom:"80px"},maskClosable:!1,onClose:e.onClose},{default:a(()=>[j("div",de,[n(v,{gutter:[16,16]},{default:a(()=>[n(l,{xs:24,sm:24,md:4,lg:4},{default:a(()=>[n(_,{src:e.user.profile_image_url},null,8,["src"])]),_:1}),n(l,{xs:24,sm:24,md:20,lg:20},{default:a(()=>[n(b,{title:e.$t(`user.${e.user.user_type}_details`),layout:"vertical",contentStyle:{fontWeight:500,marginBottom:"20px"}},{default:a(()=>[n(t,{label:e.$t("user.name")},{default:a(()=>[o(r(e.user.name),1)]),_:1},8,["label"]),n(t,{label:e.$t("user.email")},{default:a(()=>[o(r(e.user.email),1)]),_:1},8,["label"]),n(t,{label:e.$t("user.phone")},{default:a(()=>[o(r(e.user.phone?e.user.phone:"-"),1)]),_:1},8,["label"]),e.user.details?(s(),u(t,{key:0,label:e.$t("user.opening_balance")},{default:a(()=>[n(m,{amount:e.user.details.opening_balance_type=="pay"?-`${e.user.details.opening_balance}`:e.user.details.opening_balance},null,8,["amount"])]),_:1},8,["label"])):i("",!0),n(t,{label:e.$t("user.billing_address"),span:2},{default:a(()=>[o(r(e.user.address?e.user.address:"-"),1)]),_:1},8,["label"]),e.user.details?(s(),u(t,{key:1,label:e.$t("user.credit_period")},{default:a(()=>[o(r(e.user.details.credit_period?`${e.user.details.credit_period} day(s)`:"-"),1)]),_:1},8,["label"])):i("",!0),e.user.details?(s(),u(t,{key:2,label:e.$t("user.credit_limit")},{default:a(()=>[o(r(e.user.details.credit_limit?e.formatAmountCurrency(e.user.details.credit_limit):"-"),1)]),_:1},8,["label"])):i("",!0),e.user.details?(s(),u(t,{key:3,label:e.$t("common.balance")},{default:a(()=>[e.user.details&&e.user.details.due_amount?(s(),u(m,{key:0,amount:e.user.details.due_amount},null,8,["amount"])):i("",!0)]),_:1},8,["label"])):i("",!0),e.user.user_type!="staff_members"?(s(),u(t,{key:4,label:e.$t("user.tax_number")},{default:a(()=>[o(r(e.user.tax_number?e.user.tax_number:"-"),1)]),_:1},8,["label"])):i("",!0)]),_:1},8,["title"])]),_:1})]),_:1})]),n(A,{user:e.user},null,8,["user"])]),_:1},8,["title","width","open","onClose"])}const fe=C(ie,[["render",me]]);export{oe as T,ee as U,fe as a};
