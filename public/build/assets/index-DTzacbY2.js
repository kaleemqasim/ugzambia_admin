import{A as G,f as J}from"./AddEdit-utVDiQb7.js";import{_ as X,R as Y,az as L,aA as Q,aH as O,u as W,b as Z,Y as $,f as m,E as ee,V as te,r as c,o as _,c as z,a as t,w as a,G as K,aI as ne,X as M,ax as j,ak as ae,l as v,t as A,i as b,k as f,j as oe,ay as se,aB as le,aC as ie,B as de,a0 as re,q as ce,h as me,J as ue,al as _e}from"./app-BD0aDrl5.js";import{A as pe}from"./AdminPageHeader-DXZ-64N9.js";import{I as ge}from"./Import-Ddx9UCn9.js";import"./apiAdmin-Bdv_ElEE.js";import"./Upload-B7SPHbki.js";import"./SaveOutlined-C-cplDG4.js";import"./index-tfK753mH.js";import"./UploadFile-BoZ5upYO.js";import"./CloudDownloadOutlined-CS4-uZZ8.js";const fe={components:{PlusOutlined:Y,EditOutlined:L,DeleteOutlined:Q,ExclamationCircleOutlined:O,AddEdit:G,AdminPageHeader:pe,ImportCategories:ge},setup(){const l=W(),{initData:T,columns:P}=J(),{permsArray:e}=Z(),{t:o}=$(),U=window.config.category_sample_file,E=m(!1),y=m({}),i=m(!1),p=m("add"),h=m("categories"),w=m([]),d=m({}),g=m([]);ee(()=>{r()});const I=n=>{g.value=n},D=n=>({disabled:!(!n.children||n.children.length==0),name:n.xid}),C=te(()=>({selectedRowKeys:ne(g),onChange:I,getCheckboxProps:D})),r=()=>{axiosAdmin.get("categories?fields=id,xid,name,slug,parent_id,x_parent_id,image,image_url&order=parent_id asc&limit=10000").then(n=>{const s=[];var u=n.data;u.forEach(k=>{if(!k.x_parent_id)return s.push(k);const S=u.findIndex(q=>q.xid===k.x_parent_id);if(!u[S].children)return u[S].children=[k];u[S].children.push(k)}),w.value=s})};return{columns:P,addEditSuccess:n=>{p.value=="add"&&(d.value={name:"",slug:"",image:void 0,image_url:void 0,parent_id:null}),r(),i.value=!1},formData:d,editItem:n=>{d.value={name:n.name,slug:n.slug,image:n.image,image_url:n.image_url,parent_id:n.x_parent_id,_method:"PUT"},y.value=n,h.value=`categories/${n.xid}`,p.value="edit",i.value=!0},addEditVisible:i,addItem:()=>{h.value="categories",p.value="add",i.value=!0},onCloseAddEdit:()=>{d.value={...T},i.value=!1},addEditUrl:h,addEditType:p,showDeleteConfirm:n=>{M.confirm({title:o("common.delete")+"?",icon:t(O),content:o("category.delete_message"),centered:!0,okText:o("common.yes"),okType:"danger",cancelText:o("common.no"),onOk(){axiosAdmin.delete(`categories/${n}`).then(()=>{r(),j.success({message:o("common.success"),description:o("category.deleted")})})},onCancel(){}})},detailsVisible:E,viewItem:n=>{y.value=n,E.value=!0},viewData:y,allCategories:w,permsArray:e,sampleFileUrl:U,getCategories:r,selectedRowKeys:g,rowSelection:C,showSelectedDeleteConfirm:()=>{M.confirm({title:o("common.delete")+"?",icon:t(O),content:o("category.delete_message"),centered:!0,okText:o("common.yes"),okType:"danger",cancelText:o("common.no"),onOk(){const n=[];ae(g.value,s=>{n.push(axiosAdmin.delete(`categories/${s}`))}),Promise.all(n).then(s=>{l.dispatch("auth/updateVisibleSubscriptionModules"),r(),j.success({message:o("common.success"),description:o("category.deleted"),placement:"bottomRight"})})},onCancel(){}})}}}},ye={class:"table-responsive"};function he(l,T,P,e,o,U){const E=se,y=c("router-link"),i=le,p=ie,h=c("AdminPageHeader"),w=c("PlusOutlined"),d=de,g=c("ImportCategories"),I=re,D=c("DeleteOutlined"),C=ce,r=me,V=c("admin-page-filters"),B=c("AddEdit"),R=_e,F=c("EditOutlined"),H=ue,N=c("admin-page-table-content");return _(),z(K,null,[t(h,null,{header:a(()=>[t(E,{title:l.$t("menu.categories"),class:"p-0"},null,8,["title"])]),breadcrumb:a(()=>[t(p,{separator:"-",style:{"font-size":"12px"}},{default:a(()=>[t(i,null,{default:a(()=>[t(y,{to:{name:"admin.dashboard.index"}},{default:a(()=>[v(A(l.$t("menu.dashboard")),1)]),_:1},8,["to"])]),_:1}),t(i,null,{default:a(()=>[v(A(l.$t("menu.product_manager")),1)]),_:1}),t(i,null,{default:a(()=>[v(A(l.$t("menu.categories")),1)]),_:1})]),_:1})]),_:1}),t(V,null,{default:a(()=>[t(r,{gutter:[16,16]},{default:a(()=>[t(C,{xs:24,sm:24,md:12,lg:10,xl:10},{default:a(()=>[t(I,null,{default:a(()=>[e.permsArray.includes("categories_create")||e.permsArray.includes("admin")?(_(),b(I,{key:0},{default:a(()=>[t(d,{type:"primary",onClick:e.addItem},{default:a(()=>[t(w),v(" "+A(l.$t("category.add")),1)]),_:1},8,["onClick"]),t(g,{pageTitle:l.$t("category.import_categories"),sampleFileUrl:e.sampleFileUrl,importUrl:"categories/import",onOnUploadSuccess:e.getCategories},null,8,["pageTitle","sampleFileUrl","onOnUploadSuccess"])]),_:1})):f("",!0),e.selectedRowKeys.length>0&&(e.permsArray.includes("categories_delete")||e.permsArray.includes("admin"))?(_(),b(d,{key:1,type:"primary",onClick:e.showSelectedDeleteConfirm,danger:""},{icon:a(()=>[t(D)]),default:a(()=>[v(" "+A(l.$t("common.delete")),1)]),_:1},8,["onClick"])):f("",!0)]),_:1})]),_:1}),t(C,{xs:24,sm:24,md:12,lg:14,xl:14},{default:a(()=>[t(r,{gutter:[16,16],justify:"end"})]),_:1})]),_:1})]),_:1}),t(N,null,{default:a(()=>[t(B,{addEditType:e.addEditType,visible:e.addEditVisible,url:e.addEditUrl,onAddEditSuccess:e.addEditSuccess,onClosed:e.onCloseAddEdit,formData:e.formData,data:e.viewData,destroyOnClose:!0},null,8,["addEditType","visible","url","onAddEditSuccess","onClosed","formData","data"]),t(r,null,{default:a(()=>[t(C,{span:24},{default:a(()=>[oe("div",ye,[t(H,{"row-selection":e.rowSelection,columns:e.columns,"row-key":x=>x.xid,"data-source":e.allCategories,defaultExpandAllRows:!0,bordered:"",size:"middle"},{bodyCell:a(({column:x,text:n,record:s})=>[x.dataIndex==="image_url"?(_(),b(R,{key:0,width:32,src:n},null,8,["src"])):f("",!0),x.dataIndex==="action"?(_(),z(K,{key:1},[e.permsArray.includes("categories_edit")||e.permsArray.includes("admin")?(_(),b(d,{key:0,type:"primary",onClick:u=>e.editItem(s),style:{"margin-left":"4px"}},{icon:a(()=>[t(F)]),_:2},1032,["onClick"])):f("",!0),(e.permsArray.includes("categories_delete")||e.permsArray.includes("admin"))&&(!s.children||s.children.length==0)?(_(),b(d,{key:1,type:"primary",onClick:u=>e.showDeleteConfirm(s.xid),style:{"margin-left":"4px"}},{icon:a(()=>[t(D)]),_:2},1032,["onClick"])):f("",!0)],64)):f("",!0)]),_:1},8,["row-selection","columns","row-key","data-source"])])]),_:1})]),_:1})]),_:1})],64)}const Se=X(fe,[["render",he]]);export{Se as default};
