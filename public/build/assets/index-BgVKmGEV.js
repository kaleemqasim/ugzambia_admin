import{_ as M,d as ce,R as j,aT as me,aV as pe,aA as q,g as K,f as N,Y as G,b as X,V as _e,aW as fe,a6 as Y,aX as be,cA as J,r as g,o as b,i as S,w as t,a,l as f,t as r,ab as ge,c as P,M as Q,G as V,j as C,k as w,ax as he,b8 as ve,I as ye,n as Se,q as Z,h as x,aY as Ce,aD as ee,bk as ke,a0 as te,a1 as ae,bm as oe,B as ne,bn as le,cx as se,F as $e,X as De,aG as de,aw as Ee,az as we,E as Te,ay as Oe,aB as Ae,aC as Fe,aE as Ie,aF as Pe,J as Ve}from"./app-ip--di_O.js";import{p as Ue}from"./processRequest-C4hr0YEj.js";import{f as H}from"./filter-CHtmwKcL.js";import{S as ze}from"./SaveOutlined-Bxft8dsz.js";import{c as Be}from"./crud-BcLF_Da_.js";import{A as Re}from"./AdminPageHeader-DUhf2Bha.js";import"./datatable-BnqDPeRT.js";import"./index-DLuc_2zT.js";const We=ce({props:["formData","data","visible","url","addEditType"],components:{PlusOutlined:j,LoadingOutlined:me,SaveOutlined:ze,SearchOutlined:pe,DeleteOutlined:q},setup(e,{emit:n}){const d=K({formSubmitting:!1,formData:e.formData}),c=N({}),k=()=>{c.value={},n("closed")},{t:m}=G(),u=K({orderSearchTerm:[],productFetching:!1,products:[]}),l=N([]),{formatAmountCurrency:p}=X(),v=_e(()=>e.addEditType=="add"?m("product_card.add"):m("product_card.edit")),D=()=>{d.formSubmitting=!0,Ue({url:e.url,data:d.formData,success:s=>{he.success({placement:"bottomRight",message:m("common.success"),description:e.addEditType=="add"?m("product_card.created"):m("product_card.updated")}),n("addEditSuccess",s.xid),d.formSubmitting=!1,c.value={}},error:s=>{c.value=s,ve.error(m("common.fix_errors")),d.formSubmitting=!1}})},T=fe(s=>{u.products=[],s!=""&&(u.productFetching=!0,axiosAdmin.post("product-lists/search-products",{search_term:s,except:d.formData.products}).then(h=>{u.products=h.data.products,u.productFetching=!1}))},300),y=(s,_)=>{const h=_.product;l.value=[...l.value,h],d.formData.products=[...d.formData.products,h.xid],u.orderSearchTerm=[],u.products=[]},E=s=>{const _=H(l.value,$=>$.xid!=s),h=H(d.formData.products,$=>$!=s);l.value=_,d.formData.products=h};return Y(e,(s,_)=>{d.formData={...s.formData},l.value=s.addEditType=="edit"?s.data.products_details:[]}),{...be(u),fetchProducts:T,searchValueSelected:y,selectedProducts:l,rules:c,onClose:k,onSubmit:D,pageTitle:v,drawerWidth:window.innerWidth<=991?"90%":"45%",formatAmountCurrency:p,getSalesPriceWithTax:J,removeItem:E,addEditForm:d}}}),Le=C("br",null,null,-1);function Ke(e,n,d,c,k,m){const u=ye,l=Se,p=Z,v=x,D=g("SearchOutlined"),T=Ce,y=de,E=ee,s=ke,_=te,h=ae,$=oe,U=g("delete-outlined"),O=ne,A=le,z=se,B=$e,R=g("SaveOutlined"),W=De;return b(),S(W,{open:e.visible,closable:!1,centered:!0,title:e.pageTitle,onOk:e.onSubmit},{footer:t(()=>[a(O,{key:"submit",type:"primary",loading:e.addEditForm.formSubmitting,onClick:e.onSubmit},{icon:t(()=>[a(R)]),default:t(()=>[f(" "+r(e.addEditType=="add"?e.$t("common.create"):e.$t("common.update")),1)]),_:1},8,["loading","onClick"]),a(O,{key:"back",onClick:e.onClose},{default:t(()=>[f(r(e.$t("common.cancel")),1)]),_:1},8,["onClick"])]),default:t(()=>[a(B,{layout:"vertical"},{default:t(()=>[a(v,{gutter:16},{default:t(()=>[a(p,{xs:24,sm:24,md:24,lg:24},{default:t(()=>[a(l,{label:e.$t("product_card.title"),name:"title",help:e.rules.title?e.rules.title.message:null,validateStatus:e.rules.title?"error":null},{default:t(()=>[a(u,{value:e.addEditForm.formData.title,"onUpdate:value":n[0]||(n[0]=o=>e.addEditForm.formData.title=o),placeholder:e.$t("common.placeholder_default_text",[e.$t("product_card.title")])},null,8,["value","placeholder"])]),_:1},8,["label","help","validateStatus"])]),_:1})]),_:1}),a(v,{gutter:16},{default:t(()=>[a(p,{xs:24,sm:24,md:24,lg:24},{default:t(()=>[a(l,{label:e.$t("product_card.subtitle"),name:"subtitle",help:e.rules.subtitle?e.rules.subtitle.message:null,validateStatus:e.rules.subtitle?"error":null},{default:t(()=>[a(u,{value:e.addEditForm.formData.subtitle,"onUpdate:value":n[1]||(n[1]=o=>e.addEditForm.formData.subtitle=o),placeholder:e.$t("common.placeholder_default_text",[e.$t("product_card.subtitle")])},null,8,["value","placeholder"])]),_:1},8,["label","help","validateStatus"])]),_:1})]),_:1}),a(v,{gutter:16},{default:t(()=>[a(p,{xs:24,sm:24,md:24,lg:24},{default:t(()=>[a(l,{label:e.$t("product_card.products"),name:"products",help:e.rules.products?e.rules.products.message:null,validateStatus:e.rules.products?"error":null},{default:t(()=>[a(E,{value:e.orderSearchTerm,"onUpdate:value":n[2]||(n[2]=o=>e.orderSearchTerm=o),"show-search":"","filter-option":!1,placeholder:e.$t("common.select_default_text",[e.$t("product_card.products")]),style:{width:"100%"},"not-found-content":e.productFetching?void 0:null,onSearch:e.fetchProducts,"option-label-prop":"label",onFocus:n[3]||(n[3]=o=>e.products=[]),onSelect:e.searchValueSelected},ge({suffixIcon:t(()=>[a(D)]),default:t(()=>[(b(!0),P(V,null,Q(e.products,o=>(b(),S(y,{key:o.xid,value:o.xid,label:o.name,product:o},{default:t(()=>[f(" => "+r(o.name),1)]),_:2},1032,["value","label","product"]))),128))]),_:2},[e.productFetching?{name:"notFoundContent",fn:t(()=>[a(T,{size:"small"})]),key:"0"}:void 0]),1032,["value","placeholder","not-found-content","onSearch","onSelect"])]),_:1},8,["label","help","validateStatus"])]),_:1})]),_:1}),a(v,{gutter:16},{default:t(()=>[a(p,{xs:24,sm:24,md:24,lg:24},{default:t(()=>[a(z,{"item-layout":"horizontal","data-source":e.selectedProducts},{renderItem:t(({item:o})=>[a(A,null,{actions:t(()=>[a(O,{type:"link",onClick:L=>e.removeItem(o.xid)},{default:t(()=>[a(U,{style:{fontSize:"20px",color:"#f87171"}})]),_:2},1032,["onClick"])]),default:t(()=>[a($,null,{title:t(()=>[f(r(o.name),1)]),description:t(()=>[a(_,null,{default:t(()=>[C("div",null,[o.category_id?(b(),S(s,{key:0,color:"purple"},{default:t(()=>[f(r(o.category.name),1)]),_:2},1024)):w("",!0),o.brand_id?(b(),S(s,{key:1,color:"cyan"},{default:t(()=>[f(r(o.brand.name),1)]),_:2},1024)):w("",!0)])]),_:2},1024),Le,a(_,{class:"mt-5"},{default:t(()=>[C("span",null,r(e.$t("product.sales_price"))+": ",1),C("span",null,r(e.formatAmountCurrency(e.getSalesPriceWithTax(o))),1),C("del",null,r(e.formatAmountCurrency(o.details.mrp)),1)]),_:2},1024)]),avatar:t(()=>[a(h,{src:o.image_url},null,8,["src"])]),_:2},1024)]),_:2},1024)]),_:1},8,["data-source"])]),_:1})]),_:1})]),_:1})]),_:1},8,["open","title","onOk"])}const Ne=M(We,[["render",Ke]]),He=()=>{const e="product-cards?fields=xid,title,subtitle,products,x_products,products_details",{t:n}=G(),d=["products"],c={title:"",subtitle:"",products:[]},k=[{title:n("product_card.title"),dataIndex:"title",sorter:!0},{title:n("product_card.products"),dataIndex:"products",sorter:!0},{title:n("common.action"),dataIndex:"action"}],m=[{key:"title",value:n("product_card.title")}];return{url:e,initData:c,columns:k,filterableColumns:m,hashableColumns:d}},Me={components:{EyeOutlined:Ee,PlusOutlined:j,EditOutlined:we,DeleteOutlined:q,AddEdit:Ne,AdminPageHeader:Re},setup(){const{formatAmountCurrency:e,selectedWarehouse:n}=X(),{url:d,initData:c,columns:k,filterableColumns:m,hashableColumns:u}=He(),l=Be();Te(()=>{p()});const p=()=>{l.tableUrl.value={url:d},l.table.filterableColumns=m,l.fetch({page:1}),l.crudUrl.value="product-cards",l.langKey.value="product_card",l.initData.value={...c},l.formData.value={...c},l.hashableColumns.value=[...u]};return Y(n,(v,D)=>{p()}),{columns:k,...l,filterableColumns:m,formatAmountCurrency:e,getSalesPriceWithTax:J}}},je={class:"table-responsive"},qe=C("br",null,null,-1);function Ge(e,n,d,c,k,m){const u=Oe,l=g("router-link"),p=Ae,v=Fe,D=g("AdminPageHeader"),T=g("PlusOutlined"),y=ne,E=g("DeleteOutlined"),s=te,_=Z,h=de,$=ee,U=Ie,O=Pe,A=x,z=g("admin-page-filters"),B=g("AddEdit"),R=ae,W=oe,o=le,L=se,re=g("EditOutlined"),ue=Ve,ie=g("admin-page-table-content");return b(),P(V,null,[a(D,null,{header:t(()=>[a(u,{title:e.$t("menu.product_cards"),class:"p-0"},null,8,["title"])]),breadcrumb:t(()=>[a(v,{separator:"-",style:{"font-size":"12px"}},{default:t(()=>[a(p,null,{default:t(()=>[a(l,{to:{name:"admin.dashboard.index"}},{default:t(()=>[f(r(e.$t("menu.dashboard")),1)]),_:1},8,["to"])]),_:1}),a(p,null,{default:t(()=>[f(r(e.$t("menu.website_setup")),1)]),_:1}),a(p,null,{default:t(()=>[f(r(e.$t("menu.product_cards")),1)]),_:1})]),_:1})]),_:1}),a(z,null,{default:t(()=>[a(A,{gutter:[16,16]},{default:t(()=>[a(_,{xs:24,sm:24,md:12,lg:10,xl:10},{default:t(()=>[a(s,null,{default:t(()=>[a(y,{type:"primary",onClick:e.addItem},{default:t(()=>[a(T),f(" "+r(e.$t("product_card.add")),1)]),_:1},8,["onClick"]),e.table.selectedRowKeys.length>0?(b(),S(y,{key:0,type:"primary",onClick:e.showSelectedDeleteConfirm,danger:""},{icon:t(()=>[a(E)]),default:t(()=>[f(" "+r(e.$t("common.delete")),1)]),_:1},8,["onClick"])):w("",!0)]),_:1})]),_:1}),a(_,{xs:24,sm:24,md:12,lg:14,xl:14},{default:t(()=>[a(A,{gutter:[16,16],justify:"end"},{default:t(()=>[a(_,{xs:24,sm:24,md:12,lg:8,xl:8},{default:t(()=>[a(O,{compact:""},{default:t(()=>[a($,{style:{width:"25%"},value:e.table.searchColumn,"onUpdate:value":n[0]||(n[0]=i=>e.table.searchColumn=i),placeholder:e.$t("common.select_default_text",[""])},{default:t(()=>[(b(!0),P(V,null,Q(c.filterableColumns,i=>(b(),S(h,{key:i.key},{default:t(()=>[f(r(i.value),1)]),_:2},1024))),128))]),_:1},8,["value","placeholder"]),a(U,{style:{width:"75%"},value:e.table.searchString,"onUpdate:value":n[1]||(n[1]=i=>e.table.searchString=i),"show-search":"",onChange:e.onTableSearch,onSearch:e.onTableSearch,loading:e.table.filterLoading},null,8,["value","onChange","onSearch","loading"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),a(ie,null,{default:t(()=>[a(B,{addEditType:e.addEditType,visible:e.addEditVisible,url:e.addEditUrl,onAddEditSuccess:e.addEditSuccess,onClosed:e.onCloseAddEdit,formData:e.formData,data:e.viewData},null,8,["addEditType","visible","url","onAddEditSuccess","onClosed","formData","data"]),a(A,{class:"mt-20"},{default:t(()=>[a(_,{span:24},{default:t(()=>[C("div",je,[a(ue,{"row-selection":{selectedRowKeys:e.table.selectedRowKeys,onChange:e.onRowSelectChange,getCheckboxProps:i=>({disabled:!1,name:i.xid})},columns:c.columns,"row-key":i=>i.xid,"data-source":e.table.data,pagination:e.table.pagination,loading:e.table.loading,onChange:e.handleTableChange,bordered:"",size:"middle"},{bodyCell:t(({column:i,record:F})=>[i.dataIndex==="title"?(b(),P(V,{key:0},[f(r(F.title)+" ",1),qe,C("small",null,r(F.subtitle),1)],64)):w("",!0),i.dataIndex==="products"?(b(),S(L,{key:1,"item-layout":"horizontal","data-source":F.products_details},{renderItem:t(({item:I})=>[a(o,null,{default:t(()=>[a(W,{title:I.name},{avatar:t(()=>[a(R,{src:I.image_url,size:"small"},null,8,["src"])]),_:2},1032,["title"])]),_:2},1024)]),_:2},1032,["data-source"])):w("",!0),i.dataIndex==="action"?(b(),S(s,{key:2},{default:t(()=>[a(y,{type:"primary",onClick:I=>e.editItem(F)},{icon:t(()=>[a(re)]),_:2},1032,["onClick"]),a(y,{type:"primary",onClick:I=>e.showDeleteConfirm(F.xid)},{icon:t(()=>[a(E)]),_:2},1032,["onClick"])]),_:2},1024)):w("",!0)]),_:1},8,["row-selection","columns","row-key","data-source","pagination","loading","onChange"])])]),_:1})]),_:1})]),_:1})],64)}const at=M(Me,[["render",Ge]]);export{at as default};
