import{Y as ne,_ as R,d as Y,R as oe,b as Q,f as C,r as h,o as s,c as w,i as u,w as a,T as j,G as k,a as t,k as c,O as _e,B as de,H as re,bd as ke,l as m,t as p,aT as De,u as Se,E as me,a6 as se,M as F,j as x,bt as Ue,ak as Te,n as Ee,q as ie,aG as ce,aD as he,h as ue,I as Oe,p as Ie,b5 as Be,F as Pe,ap as ye,aM as Fe,J as ge,an as ve,ao as be,al as Ke,aO as Ve,aP as We,aw as Me,az as Re,aA as qe,z as ze,ay as He,aB as Le,aC as Ne,a0 as je,aE as Ge,aF as Je,bk as Ye}from"./app-DEGc35fG.js";import{c as Qe}from"./crud-_VG7jHeH.js";import{U as we}from"./UserInfo-xr3pkOq7.js";import{S as Xe}from"./StateWidget-CrE_fa0U.js";import{a as Ze}from"./apiAdmin-ChTOV1AZ.js";import{U as xe}from"./Upload-DnSHELiI.js";import{W as ea}from"./AddButton-CMTSJmcr.js";import{R as aa}from"./AddButton-rMERWMh9.js";import{A as ta,f as la}from"./AddEdit-Odo5HHtO.js";import{D as sa}from"./AddButton-CiGbMy_h.js";import{A as na,f as oa}from"./AddEdit-CEeGwTqS.js";import{S as da}from"./SaveOutlined-CN8q81Od.js";import{A as ra}from"./AdminPageHeader-xgYaoUxS.js";import{a as $e,A as Ce}from"./ArrowUpOutlined-CkhIDbOF.js";import{d as ia}from"./datatable-olxzEWY8.js";import{I as ua}from"./Import-Cg45oLSC.js";import{S as ma}from"./StaffSidebar-NUZLradg.js";import{U as pa}from"./UserOutlined-Jkj0sB5b.js";import"./index-CJVjyWpv.js";import"./AddEdit-D0LZu0TR.js";import"./SettingOutlined-CvJdFKOR.js";import"./AddEdit-BSwfNgT7.js";import"./AddEdit-lVBO8ggY.js";import"./hrmManagement-g_f4tbDZ.js";import"./filter-C51YitDG.js";import"./UploadFile--_m4qN3L.js";import"./CloudDownloadOutlined-DbfQ9kjz.js";import"./ContainerOutlined--pMKKvWF.js";const fa=()=>{const{t:e}=ne(),n="users",A=["shift_id","department_id","designation_id"],l={warehouse_id:void 0,warehouses:[],name:"",email:"",profile_image:void 0,profile_image_url:void 0,phone:"",address:"",status:"enabled",user_type:"staff_members",role_id:void 0,password:"",department_id:void 0,designation_id:void 0,shift_id:void 0},S=[{title:e("user.name"),dataIndex:"name",key:"name"},{title:e("user.email"),dataIndex:"email"},{title:e("user.department_id"),dataIndex:"department_id"},{title:e("user.designation_id"),dataIndex:"designation_id"},{title:e("user.shift_id"),dataIndex:"shift_id"},{title:e("user.status"),dataIndex:"status",key:"status"},{title:e("user.created_at"),dataIndex:"created_at"},{title:e("common.action"),dataIndex:"action"}],_=[{key:"users.name",value:e("user.name")},{key:"email",value:e("user.email")},{key:"phone",value:e("user.phone")}];return{staffMemberInitData:l,columns:S,filterableColumns:_,hashableColumns:A,staffMemberAddEditUrl:n}},_a=Y({props:{btnType:{default:"default"},tooltip:{default:!0},customType:{default:"button"}},emits:["onAddSuccess"],components:{PlusOutlined:oe,AddEdit:ta},setup(e,{emit:n}){const{permsArray:A}=Q(),{initData:l,addEditUrl:S}=la(),_=C(!1),b=C("add"),r=C({...l});return{permsArray:A,visible:_,addEditType:b,addEditUrl:S,formData:r,addEditSuccess:()=>{_.value=!1,r.value={...l},n("onAddSuccess")},onClose:()=>{_.value=!1},showAdd:()=>{_.value=!0}}}}),ca={key:0};function ha(e,n,A,l,S,_){const b=_e,r=h("PlusOutlined"),i=de,f=re,y=h("AddEdit");return e.permsArray.includes("departments_create")||e.permsArray.includes("admin")?(s(),w("div",ca,[e.customType=="menu"?(s(),u(b,{onClick:e.showAdd,key:"departments"},{icon:a(()=>[j(e.$slots,"icon")]),default:a(()=>[j(e.$slots,"default")]),_:3},8,["onClick"])):(s(),w(k,{key:1},[e.tooltip?(s(),u(f,{key:0,placement:"topLeft",title:e.$t("department.add"),"arrow-point-at-center":""},{default:a(()=>[t(i,{onClick:e.showAdd,class:"ml-5 no-border-radius",type:e.btnType},{icon:a(()=>[t(r)]),default:a(()=>[j(e.$slots,"default")]),_:3},8,["onClick","type"])]),_:3},8,["title"])):(s(),u(i,{key:1,onClick:e.showAdd,class:"ml-5 no-border-radius",type:e.btnType},{icon:a(()=>[t(r)]),default:a(()=>[j(e.$slots,"default")]),_:3},8,["onClick","type"]))],64)),t(y,{addEditType:e.addEditType,open:e.visible,url:e.addEditUrl,onAddEditSuccess:e.addEditSuccess,onClosed:e.onClose,formData:e.formData,data:e.formData,pageTitle:e.$t("department.add"),successMessage:e.$t("department.created")},null,8,["addEditType","open","url","onAddEditSuccess","onClosed","formData","data","pageTitle","successMessage"])])):c("",!0)}const ya=R(_a,[["render",ha]]),ga=Y({props:{btnType:{default:"default"},tooltip:{default:!0},customType:{default:"button"}},emits:["onAddSuccess"],components:{PlusOutlined:oe,AddEdit:na},setup(e,{emit:n}){const{permsArray:A}=Q(),{initData:l,addEditUrl:S}=oa(),_=C(!1),b=C("add"),r=C({...l});return{permsArray:A,visible:_,addEditType:b,addEditUrl:S,formData:r,addEditSuccess:()=>{_.value=!1,r.value={...l},n("onAddSuccess")},onClose:()=>{_.value=!1},showAdd:()=>{_.value=!0}}}}),va={key:0};function ba(e,n,A,l,S,_){const b=_e,r=h("PlusOutlined"),i=de,f=re,y=h("AddEdit");return e.permsArray.includes("shifts_create")||e.permsArray.includes("admin")?(s(),w("div",va,[e.customType=="menu"?(s(),u(b,{onClick:e.showAdd,key:"shifts"},{icon:a(()=>[j(e.$slots,"icon")]),default:a(()=>[j(e.$slots,"default")]),_:3},8,["onClick"])):(s(),w(k,{key:1},[e.tooltip?(s(),u(f,{key:0,placement:"topLeft",title:e.$t("shift.add"),"arrow-point-at-center":""},{default:a(()=>[t(i,{onClick:e.showAdd,class:"ml-5 no-border-radius",type:e.btnType},{icon:a(()=>[t(r)]),default:a(()=>[j(e.$slots,"default")]),_:3},8,["onClick","type"])]),_:3},8,["title"])):(s(),u(i,{key:1,onClick:e.showAdd,class:"ml-5 no-border-radius",type:e.btnType},{icon:a(()=>[t(r)]),default:a(()=>[j(e.$slots,"default")]),_:3},8,["onClick","type"]))],64)),t(y,{addEditType:e.addEditType,visible:e.visible,url:e.addEditUrl,onAddEditSuccess:e.addEditSuccess,onClosed:e.onClose,formData:e.formData,data:e.formData,pageTitle:e.$t("shift.add"),successMessage:e.$t("shift.created")},null,8,["addEditType","visible","url","onAddEditSuccess","onClosed","formData","data","pageTitle","successMessage"])])):c("",!0)}const wa=R(ga,[["render",ba]]),$a={components:{InfoCircleOutlined:ke}};function Ca(e,n,A,l,S,_){const b=h("InfoCircleOutlined"),r=re;return s(),u(r,null,{title:a(()=>[m(p(e.$t("user.warehouse_not_changable")),1)]),default:a(()=>[t(b)]),_:1})}const Aa=R($a,[["render",Ca]]),ka=Y({props:["addEditData","data","visible","url","addEditType","pageTitle","successMessage"],components:{PlusOutlined:oe,LoadingOutlined:De,SaveOutlined:da,Upload:xe,RoleAddButton:aa,WarehouseAddButton:ea,TooltipWarehouse:Aa,DepartmentAddButton:ya,DesignationAddButton:sa,ShiftAddButton:wa},setup(e,{emit:n}){const{permsArray:A,user:l,appSetting:S,selectedWarehouse:_}=Q(),{addEditRequestAdmin:b,loading:r,rules:i}=Ze(),f=C([]),y=C([]),$=C([]),g=C([]),E=C([]),D=C({}),V="roles?limit=10000",W="departments?limit=10000",M="designations?limit=10000",q="shifts?limit=10000",B="warehouses?limit=10000",P=Se(),U=C(!0);me(()=>{const v=axiosAdmin.get(V),T=axiosAdmin.get(q),J=axiosAdmin.get(W),L=axiosAdmin.get(M),d=axiosAdmin.get(B);Promise.all([v,d,J,L,T]).then(([N,I,ae,te,le])=>{f.value=N.data,y.value=ae.data,$.value=te.data,E.value=I.data,g.value=le.data}),D.value={...e.addEditData}});const O=()=>{b({url:e.url,data:D.value,successMessage:e.successMessage,success:v=>{n("addEditSuccess",v.xid),l.value.xid==v.xid&&(P.dispatch("auth/updateUser"),P.dispatch("hrm/updateSelfClocking"))}})},z=()=>{i.value={},n("closed")},o=()=>{axiosAdmin.get(V).then(v=>{f.value=v.data})},K=()=>{axiosAdmin.get(B).then(v=>{E.value=v.data})},G=()=>{axiosAdmin.get(W).then(v=>{y.value=v.data})},X=()=>{axiosAdmin.get(M).then(v=>{$.value=v.data})},Z=()=>{axiosAdmin.get(q).then(v=>{g.value=v.data})},H=(v,T)=>{D.value={...D.value,warehouse_id:v.length>0?v[0]:void 0}},ee=(v,T)=>{T&&T.title&&T.title=="admin"?U.value=!1:U.value=!0};return se(()=>e.visible,(v,T)=>{if(v)if(U.value=!0,e.addEditType=="edit"&&(U.value=!0,e.data.user_type=="staff_members"&&e.data.role&&e.data.role.name=="admin"&&(U.value=!1)),e.addEditType=="add")e.addEditData.user_type=="staff_members"?D.value={...e.addEditData,warehouse_id:_.value.xid,warehouses:[_.value.xid]}:D.value={...e.addEditData,warehouse_id:_.value.xid,warehouses:[]};else{var J=e.data.warehouse&&e.data.warehouse.xid?e.data.warehouse.xid:void 0,L=[];if(e.addEditData.user_type=="staff_members"){var d=e.data.user_warehouses;Te(d,N=>{L.push(N.x_warehouse_id)})}D.value={...e.addEditData,role_id:e.data.role&&e.data.role.xid?e.data.role.xid:void 0,warehouse_id:J,warehouses:L,opening_balance:e.data.details&&e.data.details.opening_balance?e.data.details.opening_balance:void 0,opening_balance_type:e.data.details&&e.data.details.opening_balance_type?e.data.details.opening_balance_type:void 0,credit_period:e.data.details&&e.data.details.credit_period?e.data.details.credit_period:void 0,credit_limit:e.data.details&&e.data.details.credit_limit?e.data.details.credit_limit:void 0,_method:"PUT"}}}),{loading:r,rules:i,onClose:z,onSubmit:O,roles:f,shifts:g,warehouses:E,formData:D,shiftAdded:Z,roleAdded:o,warehouseAdded:K,permsArray:A,appSetting:S,selectedWarehouse:_,warehousesChanged:H,drawerWidth:window.innerWidth<=991?"90%":"45%",warehouseVisible:U,roleChanged:ee,designationAdded:X,departmentAdded:G,departments:y,designations:$}}}),Da={key:0,style:{display:"flex"}},Sa={key:1},Ua={style:{display:"flex"}},Ta={style:{display:"flex"}},Ea={style:{display:"flex"}},Oa={style:{display:"flex"}};function Ia(e,n,A,l,S,_){const b=h("Upload"),r=Ee,i=ie,f=ce,y=he,$=h("WarehouseAddButton"),g=ue,E=h("RoleAddButton"),D=Oe,V=Ie,W=h("DepartmentAddButton"),M=h("DesignationAddButton"),q=h("ShiftAddButton"),B=Be,P=Pe,U=h("SaveOutlined"),O=de,z=ye;return s(),u(z,{title:e.pageTitle,width:e.drawerWidth,open:e.visible,"body-style":{paddingBottom:"80px"},"footer-style":{textAlign:"right"},maskClosable:!1,onClose:e.onClose},{footer:a(()=>[t(O,{type:"primary",onClick:e.onSubmit,style:{"margin-right":"8px"},loading:e.loading},{icon:a(()=>[t(U)]),default:a(()=>[m(" "+p(e.addEditType=="add"?e.$t("common.create"):e.$t("common.update")),1)]),_:1},8,["onClick","loading"]),t(O,{onClick:e.onClose},{default:a(()=>[m(p(e.$t("common.cancel")),1)]),_:1},8,["onClick"])]),default:a(()=>[t(P,{layout:"vertical"},{default:a(()=>[t(g,null,{default:a(()=>[t(i,{xs:24,sm:24,md:6,lg:6},{default:a(()=>[t(r,{label:e.$t("user.profile_image"),name:"profile_image",help:e.rules.profile_image?e.rules.profile_image.message:null,validateStatus:e.rules.profile_image?"error":null},{default:a(()=>[t(b,{formData:e.formData,folder:"user",imageField:"profile_image",onOnFileUploaded:n[0]||(n[0]=o=>{e.formData.profile_image=o.file,e.formData.profile_image_url=o.file_url})},null,8,["formData"])]),_:1},8,["label","help","validateStatus"])]),_:1}),t(i,{xs:24,sm:24,md:18,lg:18},{default:a(()=>[e.warehouseVisible?(s(),u(g,{key:0,gutter:16},{default:a(()=>[t(i,{xs:24,sm:24,md:24,lg:24},{default:a(()=>[t(r,{name:"warehouse_id",help:e.rules.warehouse_id?e.rules.warehouse_id.message:null,validateStatus:e.rules.warehouse_id?"error":null,class:"required"},{label:a(()=>[m(p(e.$t("warehouse.warehouse")),1)]),default:a(()=>[e.permsArray.includes("admin")?(s(),w("span",Da,[e.formData.user_type=="staff_members"?(s(),u(y,{key:0,value:e.formData.warehouses,"onUpdate:value":n[1]||(n[1]=o=>e.formData.warehouses=o),placeholder:e.$t("common.select_default_text",[e.$t("warehouse.warehouse")]),mode:"multiple",onChange:e.warehousesChanged},{default:a(()=>[(s(!0),w(k,null,F(e.warehouses,o=>(s(),u(f,{key:o.xid,value:o.xid},{default:a(()=>[m(p(o.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value","placeholder","onChange"])):(s(),u(y,{key:1,value:e.formData.warehouse_id,"onUpdate:value":n[2]||(n[2]=o=>e.formData.warehouse_id=o),placeholder:e.$t("common.select_default_text",[e.$t("warehouse.warehouse")])},{default:a(()=>[(s(!0),w(k,null,F(e.warehouses,o=>(s(),u(f,{key:o.xid,value:o.xid},{default:a(()=>[m(p(o.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value","placeholder"])),t($,{onOnAddSuccess:e.warehouseAdded},null,8,["onOnAddSuccess"])])):(s(),w("span",Sa,[t(y,{value:e.selectedWarehouse.xid,placeholder:e.$t("common.select_default_text",[e.$t("warehouse.warehouse")]),disabled:""},{default:a(()=>[t(f,{value:e.selectedWarehouse.xid},{default:a(()=>[m(p(e.selectedWarehouse.name),1)]),_:1},8,["value"])]),_:1},8,["value","placeholder"])]))]),_:1},8,["help","validateStatus"])]),_:1})]),_:1})):c("",!0),e.formData.user_type=="staff_members"&&e.permsArray.includes("admin")?(s(),u(g,{key:1,gutter:16},{default:a(()=>[t(i,{xs:24,sm:24,md:24,lg:24},{default:a(()=>[t(r,{label:e.$t("user.role"),name:"role_id",help:e.rules.role_id?e.rules.role_id.message:null,validateStatus:e.rules.role_id?"error":null,class:"required"},{default:a(()=>[x("span",Ua,[t(y,{value:e.formData.role_id,"onUpdate:value":n[3]||(n[3]=o=>e.formData.role_id=o),placeholder:e.$t("common.select_default_text",[e.$t("user.role")]),allowClear:!0,onChange:e.roleChanged},{default:a(()=>[(s(!0),w(k,null,F(e.roles,o=>(s(),u(f,{key:o.xid,value:o.xid,title:o.name},{default:a(()=>[m(p(o.display_name),1)]),_:2},1032,["value","title"]))),128))]),_:1},8,["value","placeholder","onChange"]),t(E,{onOnAddSuccess:e.roleAdded},null,8,["onOnAddSuccess"])])]),_:1},8,["label","help","validateStatus"])]),_:1})]),_:1})):c("",!0),t(g,{gutter:16},{default:a(()=>[t(i,{xs:24,sm:24,md:12,lg:12},{default:a(()=>[t(r,{label:e.$t("user.name"),name:"name",help:e.rules.name?e.rules.name.message:null,validateStatus:e.rules.name?"error":null,class:"required"},{default:a(()=>[t(D,{value:e.formData.name,"onUpdate:value":n[4]||(n[4]=o=>e.formData.name=o),placeholder:e.$t("common.placeholder_default_text",[e.$t("user.name")])},null,8,["value","placeholder"])]),_:1},8,["label","help","validateStatus"])]),_:1}),t(i,{xs:24,sm:24,md:12,lg:12},{default:a(()=>[t(r,{label:e.$t("user.phone"),name:"phone",help:e.rules.phone?e.rules.phone.message:null,validateStatus:e.rules.phone?"error":null,class:"required"},{default:a(()=>[t(D,{value:e.formData.phone,"onUpdate:value":n[5]||(n[5]=o=>e.formData.phone=o),placeholder:e.$t("common.placeholder_default_text",[e.$t("user.phone")])},null,8,["value","placeholder"])]),_:1},8,["label","help","validateStatus"])]),_:1})]),_:1}),t(g,{gutter:16},{default:a(()=>[t(i,{xs:24,sm:24,md:12,lg:12},{default:a(()=>[t(r,{label:e.$t("user.email"),name:"email",help:e.rules.email?e.rules.email.message:null,validateStatus:e.rules.email?"error":null,class:Ue({required:e.formData.user_type=="staff_members"})},{default:a(()=>[t(D,{value:e.formData.email,"onUpdate:value":n[6]||(n[6]=o=>e.formData.email=o),placeholder:e.$t("common.placeholder_default_text",[e.$t("user.email")])},null,8,["value","placeholder"])]),_:1},8,["label","help","validateStatus","class"])]),_:1}),t(i,{xs:24,sm:24,md:12,lg:12},{default:a(()=>[t(r,{label:e.$t("user.status"),name:"status",help:e.rules.status?e.rules.status.message:null,validateStatus:e.rules.status?"error":null,class:"required"},{default:a(()=>[t(y,{value:e.formData.status,"onUpdate:value":n[7]||(n[7]=o=>e.formData.status=o),placeholder:e.$t("common.select_default_text",[e.$t("user.status")])},{default:a(()=>[t(f,{value:"enabled"},{default:a(()=>[m(p(e.$t("common.enabled")),1)]),_:1}),t(f,{value:"disabled"},{default:a(()=>[m(p(e.$t("common.disabled")),1)]),_:1})]),_:1},8,["value","placeholder"])]),_:1},8,["label","help","validateStatus"])]),_:1})]),_:1}),t(g,null,{default:a(()=>[t(i,{span:24},{default:a(()=>[t(r,{label:e.$t("user.password"),name:"password",help:e.rules.password?e.rules.password.message:null,validateStatus:e.rules.password?"error":null,class:"required"},{default:a(()=>[t(V,{value:e.formData.password,"onUpdate:value":n[8]||(n[8]=o=>e.formData.password=o),placeholder:e.$t("common.placeholder_default_text",[e.$t("user.password")])},null,8,["value","placeholder"])]),_:1},8,["label","help","validateStatus"])]),_:1})]),_:1})]),_:1})]),_:1}),e.formData.user_type=="staff_members"?(s(),u(g,{key:0,gutter:16},{default:a(()=>[t(i,{xs:24,sm:24,md:12,lg:12},{default:a(()=>[t(r,{label:e.$t("user.department_id"),name:"department_id",help:e.rules.department_id?e.rules.department_id.message:null,validateStatus:e.rules.department_id?"error":null},{default:a(()=>[x("span",Ta,[t(y,{value:e.formData.department_id,"onUpdate:value":n[9]||(n[9]=o=>e.formData.department_id=o),placeholder:e.$t("common.select_default_text",[e.$t("user.department_id")]),allowClear:!0},{default:a(()=>[(s(!0),w(k,null,F(e.departments,o=>(s(),u(f,{key:o.xid,value:o.xid,title:o.name},{default:a(()=>[m(p(o.name),1)]),_:2},1032,["value","title"]))),128))]),_:1},8,["value","placeholder"]),t(W,{onOnAddSuccess:e.departmentAdded},null,8,["onOnAddSuccess"])])]),_:1},8,["label","help","validateStatus"])]),_:1}),t(i,{xs:24,sm:24,md:12,lg:12},{default:a(()=>[t(r,{label:e.$t("user.designation_id"),name:"designation_id",help:e.rules.designation_id?e.rules.designation_id.message:null,validateStatus:e.rules.designation_id?"error":null},{default:a(()=>[x("span",Ea,[t(y,{value:e.formData.designation_id,"onUpdate:value":n[10]||(n[10]=o=>e.formData.designation_id=o),placeholder:e.$t("common.select_default_text",[e.$t("user.designation_id")]),allowClear:!0},{default:a(()=>[(s(!0),w(k,null,F(e.designations,o=>(s(),u(f,{key:o.xid,value:o.xid,title:o.name},{default:a(()=>[m(p(o.name),1)]),_:2},1032,["value","title"]))),128))]),_:1},8,["value","placeholder"]),t(M,{onOnAddSuccess:e.designationAdded},null,8,["onOnAddSuccess"])])]),_:1},8,["label","help","validateStatus"])]),_:1})]),_:1})):c("",!0),e.formData.user_type=="staff_members"?(s(),u(g,{key:1,gutter:16},{default:a(()=>[t(i,{xs:24,sm:24,md:12,lg:12},{default:a(()=>[t(r,{label:e.$t("user.shift_id"),name:"shift_id",help:e.rules.shift_id?e.rules.shift_id.message:null,validateStatus:e.rules.shift_id?"error":null},{default:a(()=>[x("span",Oa,[t(y,{value:e.formData.shift_id,"onUpdate:value":n[11]||(n[11]=o=>e.formData.shift_id=o),placeholder:e.$t("common.select_default_text",[e.$t("user.shift_id")]),allowClear:!0},{default:a(()=>[(s(!0),w(k,null,F(e.shifts,o=>(s(),u(f,{key:o.xid,value:o.xid,title:o.name},{default:a(()=>[m(p(o.name),1)]),_:2},1032,["value","title"]))),128))]),_:1},8,["value","placeholder"]),t(q,{onOnAddSuccess:e.shiftAdded},null,8,["onOnAddSuccess"])])]),_:1},8,["label","help","validateStatus"])]),_:1})]),_:1})):c("",!0),t(g,{gutter:16},{default:a(()=>[t(i,{xs:24,sm:24,md:24,lg:24},{default:a(()=>[t(r,{label:e.formData.user_type=="staff_members"?e.$t("user.address"):e.$t("user.billing_address"),name:"address",help:e.rules.address?e.rules.address.message:null,validateStatus:e.rules.address?"error":null},{default:a(()=>[t(B,{value:e.formData.address,"onUpdate:value":n[12]||(n[12]=o=>e.formData.address=o),placeholder:e.$t("common.placeholder_default_text",[e.formData.user_type=="staff_members"?e.$t("user.address"):e.$t("user.billing_address")]),"auto-size":{minRows:2,maxRows:3}},null,8,["value","placeholder"])]),_:1},8,["label","help","validateStatus"])]),_:1})]),_:1})]),_:1})]),_:1},8,["title","width","open","onClose"])}const Ba=R(ka,[["render",Ia]]),Pa=Y({props:["amount"],components:{ArrowDownOutlined:$e,ArrowUpOutlined:Ce},setup(){const{formatAmountCurrency:e}=Q();return{formatAmountCurrency:e}}}),Fa={key:0};function Ka(e,n,A,l,S,_){const b=h("ArrowUpOutlined"),r=Fe,i=re,f=h("ArrowDownOutlined");return e.amount<0?(s(),u(i,{key:0,title:e.$t("payments.you_will_pay")},{default:a(()=>[t(r,null,{default:a(()=>[t(b,{style:{color:"red"}}),m(" "+p(e.formatAmountCurrency(Math.abs(e.amount))),1)]),_:1})]),_:1},8,["title"])):(s(),u(i,{key:1,title:e.$t("payments.you_will_receive")},{default:a(()=>[t(r,null,{default:a(()=>[e.amount>0?(s(),w("span",Fa,[t(f,{style:{color:"green"}})])):c("",!0),m(" "+p(e.formatAmountCurrency(e.amount)),1)]),_:1})]),_:1},8,["title"]))}const Ae=R(Pa,[["render",Ka]]),Va=()=>{const{t:e}=ne(),n=["user_id"],A=[{key:"name",value:e("user.name")}],l=[{title:e("payments.date"),dataIndex:"date"},{title:e("payments.transaction_number"),dataIndex:"transaction_number"},{title:e("payments.payment_type"),dataIndex:"payment_type"},{title:e("payments.user"),dataIndex:"user_id"},{title:e("payments.amount"),dataIndex:"amount"}];return{transactionsFilterableColumns:A,transactionsColumns:l,transactionsHashableColumns:n}},Wa=Y({props:{user_id:null,result_type:{default:"all",type:String}},components:{UserInfo:we},setup(e){const{transactionsColumns:n,transactionsHashableColumns:A}=Va(),{formatDate:l,formatAmountCurrency:S}=Q(),_=ia();me(()=>{b(e)});const b=r=>{const i={},f={result_type:r.result_type};r.user_id&&r.user_id!=null&&(f.user_id=r.user_id),_.tableUrl.value={url:"warehouse-history?fields=id,xid,date,type,amount,transaction_number,user_id,x_user_id,user{id,xid,name,profile_image,profile_image_url,user_type}",filters:i,extraFilters:f},_.hashable.value=[...A],_.table.sorter={field:"date",order:"asc"},_.fetch({page:1})};return se(e,(r,i)=>{b(r)}),{transactionsColumns:n,..._,formatDate:l,formatAmountCurrency:S}}}),Ma={key:0,class:"table-responsive"};function Ra(e,n,A,l,S,_){const b=h("UserInfo"),r=ge,i=ie,f=ue;return s(),u(f,null,{default:a(()=>[t(i,{span:24},{default:a(()=>[e.table.loading?c("",!0):(s(),w("div",Ma,[t(r,{columns:e.transactionsColumns,"row-key":y=>y.xid,"data-source":e.table.data,pagination:e.table.pagination,loading:e.table.loading,onChange:e.handleTableChange},{bodyCell:a(({column:y,record:$})=>[y.dataIndex==="date"?(s(),w(k,{key:0},[m(p(e.formatDate($.date)),1)],64)):c("",!0),y.dataIndex==="payment_type"?(s(),w(k,{key:1},[m(p($.type),1)],64)):c("",!0),y.dataIndex==="user_id"?(s(),u(b,{key:2,user:$.user},null,8,["user"])):c("",!0),y.dataIndex==="amount"?(s(),w(k,{key:3},[m(p(e.formatAmountCurrency($.amount)),1)],64)):c("",!0)]),_:1},8,["columns","row-key","data-source","pagination","loading","onChange"])]))]),_:1})]),_:1})}const qa=R(Wa,[["render",Ra]]),za=Y({props:["user"],components:{Transactions:qa},setup(){return{activeKey:C("transactions")}}});function Ha(e,n,A,l,S,_){const b=h("Transactions"),r=ve,i=be;return s(),u(i,{activeKey:e.activeKey,"onUpdate:activeKey":n[0]||(n[0]=f=>e.activeKey=f)},{default:a(()=>[t(r,{key:"transactions",tab:e.$t("payments.transactions")},{default:a(()=>[t(b,{user_id:e.user.xid,result_type:e.user.user_type=="staff_members"?"staff_member":"customer_supplier"},null,8,["user_id","result_type"])]),_:1},8,["tab"])]),_:1},8,["activeKey"])}const La=R(za,[["render",Ha]]),Na=Y({props:["user","visible"],emits:["closed"],components:{UserBalance:Ae,UserDetails:La},setup(e,{emit:n}){const{formatAmountCurrency:A}=Q();return ne(),{formatAmountCurrency:A,onClose:()=>{n("closed")},drawerWidth:window.innerWidth<=991?"90%":"60%"}}}),ja={class:"user-details"};function Ga(e,n,A,l,S,_){const b=Ke,r=ie,i=Ve,f=h("UserBalance"),y=We,$=ue,g=h("UserDetails"),E=ye;return s(),u(E,{title:e.user.name,width:e.drawerWidth,open:e.visible,"body-style":{paddingBottom:"80px"},maskClosable:!1,onClose:e.onClose},{default:a(()=>[x("div",ja,[t($,{gutter:[16,16]},{default:a(()=>[t(r,{xs:24,sm:24,md:4,lg:4},{default:a(()=>[t(b,{src:e.user.profile_image_url},null,8,["src"])]),_:1}),t(r,{xs:24,sm:24,md:20,lg:20},{default:a(()=>[t(y,{title:e.$t(`user.${e.user.user_type}_details`),layout:"vertical",contentStyle:{fontWeight:500,marginBottom:"20px"}},{default:a(()=>[t(i,{label:e.$t("user.name")},{default:a(()=>[m(p(e.user.name),1)]),_:1},8,["label"]),t(i,{label:e.$t("user.email")},{default:a(()=>[m(p(e.user.email),1)]),_:1},8,["label"]),t(i,{label:e.$t("user.phone")},{default:a(()=>[m(p(e.user.phone?e.user.phone:"-"),1)]),_:1},8,["label"]),e.user.details?(s(),u(i,{key:0,label:e.$t("user.opening_balance")},{default:a(()=>[t(f,{amount:e.user.details.opening_balance_type=="pay"?-`${e.user.details.opening_balance}`:e.user.details.opening_balance},null,8,["amount"])]),_:1},8,["label"])):c("",!0),t(i,{label:e.$t("user.billing_address"),span:2},{default:a(()=>[m(p(e.user.address?e.user.address:"-"),1)]),_:1},8,["label"]),e.user.details?(s(),u(i,{key:1,label:e.$t("user.credit_period")},{default:a(()=>[m(p(e.user.details.credit_period?`${e.user.details.credit_period} day(s)`:"-"),1)]),_:1},8,["label"])):c("",!0),e.user.details?(s(),u(i,{key:2,label:e.$t("user.credit_limit")},{default:a(()=>[m(p(e.user.details.credit_limit?e.formatAmountCurrency(e.user.details.credit_limit):"-"),1)]),_:1},8,["label"])):c("",!0),e.user.details?(s(),u(i,{key:3,label:e.$t("common.balance")},{default:a(()=>[e.user.details&&e.user.details.due_amount?(s(),u(f,{key:0,amount:e.user.details.due_amount},null,8,["amount"])):c("",!0)]),_:1},8,["label"])):c("",!0)]),_:1},8,["title"])]),_:1})]),_:1})]),t(g,{user:e.user},null,8,["user"])]),_:1},8,["title","width","open","onClose"])}const Ja=R(Na,[["render",Ga]]),Ya={components:{EyeOutlined:Me,PlusOutlined:oe,EditOutlined:Re,DeleteOutlined:qe,UserOutlined:pa,ArrowUpOutlined:Ce,ArrowDownOutlined:$e,AddEdit:Ba,UserInfo:we,StateWidget:Xe,AdminPageHeader:ra,UserBalance:Ae,UserView:Ja,ImportUsers:ua,StaffSidebar:ma},setup(){const{t:e}=ne(),{statusColors:n,userStatus:A,permsArray:l,formatDateTime:S,user:_,selectedWarehouse:b}=Q(),{staffMemberInitData:r,columns:i,filterableColumns:f,hashableColumns:y}=fa(),$=Qe(),g=ze(),E=C("users"),D=C([]),V=C([]),W="departments?fields=id,xid,name",M="designations?fields=id,xid,name",q="?fields=id,xid,user_type,name,email,profile_image,profile_image_url,is_walkin_customer,phone,address,shipping_address,status,created_at,details{opening_balance,opening_balance_type,credit_period,credit_limit,due_amount,warehouse_id,x_warehouse_id},details:warehouse{id,xid,name},role_id,role{id,xid,name,display_name},warehouse_id,x_warehouse_id,warehouse{xid,name},userWarehouses{user_id,x_user_id,warehouse_id,x_warehouse_id},department_id,x_department_id,department{id,xid,name},designation_id,x_designation_id,designation{id,xid,name},shift_id,x_shift_id,shift{id,xid,name}",B=C(void 0),P=C("all"),U=C("all"),O=C([]),z=C(""),o=C(""),K=C(""),G=C({shift_id:void 0,department_id:void 0,designation_id:void 0}),X=C([]);me(()=>{H(),$.table.filterableColumns=f,Z(),ee()});const Z=()=>{$.initData.value={...r},$.formData.value={...r},$.hashableColumns.value=[...y],$.langKey.value="staff_member",O.value=i,z.value=window.config.staff_member_sample_file,o.value=e("staff_member.import_staff_members"),K.value="users/import",$.restFormData()},H=()=>{$.crudUrl.value=E.value;var v="",T={};B.value!=null&&B.value!="all"&&(v+=`status eq "${B.value}"`),U.value!=null&&U.value!="all"&&E.value!="users"&&(T.search_due_type=U.value),$.tableUrl.value={url:`${E.value}${q}`,filterString:v,extraFilters:T,filters:G},$.fetch({page:1})},ee=()=>{const v=axiosAdmin.get("shifts?limit=10000"),T=axiosAdmin.get(W),J=axiosAdmin.get(M);Promise.all([v,T,J]).then(([L,d,N])=>{X.value=L.data,D.value=d.data,V.value=N.data})};return se(()=>g.meta.menuKey,(v,T)=>{E.value="users",B.value=void 0,$.table.searchColumn=void 0,$.table.searchString="",U.value="all",H(),Z()}),se(b,(v,T)=>{H()}),{statusColors:n,userStatus:A,filterableColumns:f,userType:E,tableColumns:O,searchStatus:B,setUrlData:H,searchDueType:U,activeTabKey:P,...$,permsArray:l,formatDateTime:S,user:_,sampleFileUrl:z,importPageTitle:o,importUrl:K,filters:G,shifts:X,departments:D,designations:V}}},Qa={class:"table-responsive"};function Xa(e,n,A,l,S,_){const b=He,r=h("router-link"),i=Le,f=Ne,y=h("AdminPageHeader"),$=h("StaffSidebar"),g=ie,E=h("PlusOutlined"),D=de,V=h("ImportUsers"),W=je,M=h("DeleteOutlined"),q=Ge,B=Je,P=ce,U=he,O=ue,z=h("admin-page-filters"),o=h("AddEdit"),K=ve,G=be,X=h("user-info"),Z=Ye,H=h("UserBalance"),ee=h("EyeOutlined"),v=h("EditOutlined"),T=ge,J=h("UserView"),L=h("admin-page-table-content");return s(),w(k,null,[t(y,null,{header:a(()=>[t(b,{title:e.$t("menu.staff_members"),class:"p-0"},null,8,["title"])]),breadcrumb:a(()=>[t(f,{separator:"-",style:{"font-size":"12px"}},{default:a(()=>[t(i,null,{default:a(()=>[t(r,{to:{name:"admin.dashboard.index"}},{default:a(()=>[m(p(e.$t("menu.dashboard")),1)]),_:1},8,["to"])]),_:1}),t(i,null,{default:a(()=>[m(p(e.$t("menu.staff")),1)]),_:1})]),_:1})]),_:1}),t(O,null,{default:a(()=>[t(g,{xs:24,sm:24,md:24,lg:4,xl:4,class:"bg-setting-sidebar"},{default:a(()=>[t($)]),_:1}),t(g,{xs:24,sm:24,md:24,lg:20,xl:20},{default:a(()=>[t(z,null,{default:a(()=>[t(O,{gutter:[16,16]},{default:a(()=>[t(g,{xs:24,sm:24,md:12,lg:10,xl:10},{default:a(()=>[t(W,null,{default:a(()=>[l.permsArray.includes(`${l.userType}_create`)||l.permsArray.includes("admin")?(s(),u(W,{key:0},{default:a(()=>[t(D,{type:"primary",onClick:e.addItem},{default:a(()=>[t(E),m(" "+p(e.$t(`${e.langKey}.add`)),1)]),_:1},8,["onClick"]),t(V,{pageTitle:l.importPageTitle,sampleFileUrl:l.sampleFileUrl,importUrl:l.importUrl,onOnUploadSuccess:l.setUrlData},null,8,["pageTitle","sampleFileUrl","importUrl","onOnUploadSuccess"])]),_:1})):c("",!0),e.table.selectedRowKeys.length>0&&(l.permsArray.includes(`${l.userType}_delete`)||l.permsArray.includes("admin"))?(s(),u(D,{key:1,type:"primary",onClick:e.showSelectedDeleteConfirm,danger:""},{icon:a(()=>[t(M)]),default:a(()=>[m(" "+p(e.$t("common.delete")),1)]),_:1},8,["onClick"])):c("",!0)]),_:1})]),_:1}),t(g,{xs:24,sm:24,md:12,lg:14,xl:14},{default:a(()=>[t(O,{gutter:[16,16],justify:"end"},{default:a(()=>[t(g,{xs:24,sm:24,md:12,lg:6,xl:6},{default:a(()=>[t(B,{compact:""},{default:a(()=>[t(q,{style:{width:"100%"},value:e.table.searchString,"onUpdate:value":n[0]||(n[0]=d=>e.table.searchString=d),"show-search":"",onChange:e.onTableSearch,onSearch:e.onTableSearch,loading:e.table.filterLoading,placeholder:e.$t("common.placeholder_search_text",[e.$t("common.name")])},null,8,["value","onChange","onSearch","loading","placeholder"])]),_:1})]),_:1}),l.userType&&l.userType!="users"?(s(),u(g,{key:0,xs:24,sm:24,md:12,lg:6,xl:6},{default:a(()=>[t(U,{value:l.searchStatus,"onUpdate:value":n[1]||(n[1]=d=>l.searchStatus=d),onChange:l.setUrlData,"show-search":"",style:{width:"100%"},placeholder:e.$t("common.select_default_text",[e.$t("user.status")]),allowClear:!0,optionFilterProp:"label"},{default:a(()=>[(s(!0),w(k,null,F(l.userStatus,d=>(s(),u(P,{key:d.key,value:d.key,label:d.value},{default:a(()=>[m(p(d.value),1)]),_:2},1032,["value","label"]))),128))]),_:1},8,["value","onChange","placeholder"])]),_:1})):c("",!0),t(g,{xs:24,sm:24,md:8,lg:6,xl:6},{default:a(()=>[t(U,{value:l.filters.shift_id,"onUpdate:value":n[2]||(n[2]=d=>l.filters.shift_id=d),placeholder:e.$t("common.select_default_text",[e.$t("user.shift_id")]),allowClear:!0,style:{width:"100%"},optionFilterProp:"title","show-search":"",onChange:l.setUrlData},{default:a(()=>[(s(!0),w(k,null,F(l.shifts,d=>(s(),u(P,{key:d.xid,title:d.name,value:d.xid},{default:a(()=>[m(p(d.name),1)]),_:2},1032,["title","value"]))),128))]),_:1},8,["value","placeholder","onChange"])]),_:1}),t(g,{xs:24,sm:24,md:8,lg:6,xl:6},{default:a(()=>[t(U,{value:l.filters.department_id,"onUpdate:value":n[3]||(n[3]=d=>l.filters.department_id=d),placeholder:e.$t("common.select_default_text",[e.$t("user.department_id")]),allowClear:!0,style:{width:"100%"},optionFilterProp:"title","show-search":"",onChange:l.setUrlData},{default:a(()=>[(s(!0),w(k,null,F(l.departments,d=>(s(),u(P,{key:d.xid,title:d.name,value:d.xid},{default:a(()=>[m(p(d.name),1)]),_:2},1032,["title","value"]))),128))]),_:1},8,["value","placeholder","onChange"])]),_:1}),t(g,{xs:24,sm:24,md:8,lg:6,xl:6},{default:a(()=>[t(U,{value:l.filters.designation_id,"onUpdate:value":n[4]||(n[4]=d=>l.filters.designation_id=d),placeholder:e.$t("common.select_default_text",[e.$t("user.designation_id")]),allowClear:!0,style:{width:"100%"},optionFilterProp:"title","show-search":"",onChange:l.setUrlData},{default:a(()=>[(s(!0),w(k,null,F(l.designations,d=>(s(),u(P,{key:d.xid,title:d.name,value:d.xid},{default:a(()=>[m(p(d.name),1)]),_:2},1032,["title","value"]))),128))]),_:1},8,["value","placeholder","onChange"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),t(L,null,{default:a(()=>[t(o,{addEditType:e.addEditType,visible:e.addEditVisible,url:e.addEditUrl,onAddEditSuccess:e.addEditSuccess,onClosed:e.onCloseAddEdit,addEditData:e.formData,data:e.viewData,pageTitle:e.pageTitle,successMessage:e.successMessage},null,8,["addEditType","visible","url","onAddEditSuccess","onClosed","addEditData","data","pageTitle","successMessage"]),l.userType&&l.userType=="users"?(s(),u(O,{key:0},{default:a(()=>[t(g,{span:24},{default:a(()=>[t(G,{activeKey:l.searchStatus,"onUpdate:activeKey":n[5]||(n[5]=d=>l.searchStatus=d),onChange:l.setUrlData},{default:a(()=>[t(K,{key:"all",tab:`${e.$t("common.all")} ${e.$t("menu.users")}`},null,8,["tab"]),(s(!0),w(k,null,F(l.userStatus,d=>(s(),u(K,{key:d.key,tab:`${d.value} ${e.$t("menu.users")}`},null,8,["tab"]))),128))]),_:1},8,["activeKey","onChange"])]),_:1})]),_:1})):c("",!0),l.userType&&l.userType!="users"?(s(),u(O,{key:1},{default:a(()=>[t(g,{span:24},{default:a(()=>[t(G,{activeKey:l.searchDueType,"onUpdate:activeKey":n[6]||(n[6]=d=>l.searchDueType=d),onChange:l.setUrlData},{default:a(()=>[t(K,{key:"all",tab:`${e.$t("common.all")}`},null,8,["tab"]),t(K,{key:"receive",tab:`${e.$t("user.to_receive")}`},null,8,["tab"]),t(K,{key:"pay",tab:`${e.$t("user.to_pay")}`},null,8,["tab"])]),_:1},8,["activeKey","onChange"])]),_:1})]),_:1})):c("",!0),t(O,{gutter:[15,15]},{default:a(()=>[t(g,{span:24},{default:a(()=>[x("div",Qa,[t(T,{"row-selection":{selectedRowKeys:e.table.selectedRowKeys,onChange:e.onRowSelectChange,getCheckboxProps:d=>({disabled:!!(l.user.xid==d.xid||d.is_walkin_customer),name:d.xid})},columns:l.tableColumns,"row-key":d=>d.xid,"data-source":e.table.data,pagination:e.table.pagination,loading:e.table.loading,onChange:e.handleTableChange,bordered:"",size:"middle"},{bodyCell:a(({column:d,text:N,record:I})=>{var ae,te,le,pe;return[d.dataIndex==="name"?(s(),u(X,{key:0,user:I},null,8,["user"])):c("",!0),d.dataIndex==="status"?(s(),u(Z,{key:1,color:l.statusColors[N]},{default:a(()=>[m(p(e.$t(`common.${N}`)),1)]),_:2},1032,["color"])):c("",!0),d.dataIndex=="department_id"?(s(),w(k,{key:2},[m(p((ae=I.department)==null?void 0:ae.name),1)],64)):c("",!0),d.dataIndex=="designation_id"?(s(),w(k,{key:3},[m(p((te=I.designation)==null?void 0:te.name),1)],64)):c("",!0),d.dataIndex=="shift_id"?(s(),w(k,{key:4},[m(p((le=I.shift)==null?void 0:le.name),1)],64)):c("",!0),d.dataIndex==="created_at"?(s(),w(k,{key:5},[m(p(l.formatDateTime(I.created_at)),1)],64)):c("",!0),d.dataIndex==="balance"?(s(),u(H,{key:6,amount:(pe=I.details)==null?void 0:pe.due_amount},null,8,["amount"])):c("",!0),d.dataIndex==="action"?(s(),w(k,{key:7},[t(D,{type:"primary",onClick:fe=>e.viewItem(I),style:{"margin-left":"4px"}},{icon:a(()=>[t(ee)]),_:2},1032,["onClick"]),l.permsArray.includes(`${l.userType}_edit`)||l.permsArray.includes("admin")?(s(),u(D,{key:0,type:"primary",onClick:fe=>e.editItem(I),style:{"margin-left":"4px"}},{icon:a(()=>[t(v)]),_:2},1032,["onClick"])):c("",!0),(l.permsArray.includes(`${l.userType}_delete`)||l.permsArray.includes("admin"))&&l.user.xid!=I.xid&&!I.is_walkin_customer?(s(),u(D,{key:1,type:"primary",onClick:fe=>e.showDeleteConfirm(I.xid),style:{"margin-left":"4px"}},{icon:a(()=>[t(M)]),_:2},1032,["onClick"])):c("",!0)],64)):c("",!0)]}),_:1},8,["row-selection","columns","row-key","data-source","pagination","loading","onChange"])])]),_:1})]),_:1}),t(J,{user:e.viewData,visible:e.detailsVisible,onClosed:e.onCloseDetails},null,8,["user","visible","onClosed"])]),_:1})]),_:1})]),_:1})],64)}const Dt=R(Ya,[["render",Xa]]);export{Dt as default};
