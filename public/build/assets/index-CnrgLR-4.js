import{_ as G,R as J,az as W,aA as x,b as Q,g as X,f as Y,z as Z,E as $,V as ee,a6 as M,r as _,o as l,c as g,a as n,w as a,G as b,l as r,t as i,i as f,k as c,M as R,j as ae,ay as ne,aB as te,aC as oe,B as le,a0 as se,q as de,aD as re,aE as ie,aF as me,h as ue,aL as _e,aM as pe,aN as ce,J as ye,aG as fe}from"./app-CLFRnoDY.js";import{A as ge,f as be}from"./AddEdit-BNLV0cDr.js";import{c as he}from"./crud-DbgMj5HC.js";import{A as ve}from"./AdminPageHeader-BWk1lolr.js";import{U as Ce}from"./UserInfo-COTIn23h.js";import"./apiAdmin-DLxgfbyg.js";import"./AddButton-Eak-IC87.js";import"./AddEdit-CVOVN6xx.js";import"./SaveOutlined-DPGbn-Vn.js";import"./DateTimePicker-CsDDtNRt.js";import"./datatable-0ZFf-dh3.js";import"./filter-D_GgseXO.js";import"./index-01DLus6S.js";const ke={components:{PlusOutlined:J,EditOutlined:W,DeleteOutlined:x,AddEdit:ge,AdminPageHeader:ve,UserInfo:Ce},setup(){const{addEditUrl:e,initData:d,columns:O,paymentType:t,menuParent:E,hashableColumns:V,filterableColumns:A}=be(),s=he(),{permsArray:h,formatAmountCurrency:D,selectedWarehouse:S,formatDate:P}=Q(),p=X({user_id:void 0}),v=Y({}),C=Z();$(()=>{w(),m()});const m=()=>{s.tableUrl.value={url:`payment-${t.value}?fields=id,xid,date,amount,notes,payment_mode_id,payment_number,payment_type,payment_mode_id,x_payment_mode_id,paymentMode{id,xid,name},user_id,x_user_id,user{id,xid,name,profile_image,profile_image_url,user_type}`,filterString:`payment_type eq "${t.value}"`,filters:p},s.table.filterableColumns=A,s.fetch({page:1}),s.crudUrl.value=e.value,s.langKey.value="payments",s.initData.value={...d.value},s.formData.value={...d.value},s.hashableColumns.value=[...V]},w=()=>{const u=axiosAdmin.post("customer-suppliers");Promise.all([u]).then(([y])=>{v.value=y.data})},T=ee(()=>{let u=0;return s.table.data.forEach(y=>{u+=y.amount}),{totalAmount:u}});return M(S,(u,y)=>{m()}),M(()=>C.meta.paymentType,(u,y)=>{(u=="in"||u=="out")&&(t.value=C.meta.paymentType,E.value=C.meta.menuParent,e.value=`payment-${t.value}`,d.value={...d.value,payment_type:t.value},p.user_id=void 0,m())}),{columns:O,...s,permsArray:h,formatAmountCurrency:D,paymentType:t,menuParent:E,filters:p,users:v,setUrlData:m,filterableColumns:A,formatDate:P,totals:T}}},Ae={class:"table-responsive"};function we(e,d,O,t,E,V){const A=ne,s=_("router-link"),h=te,D=oe,S=_("AdminPageHeader"),P=_("PlusOutlined"),p=le,v=_("DeleteOutlined"),C=se,m=de,w=fe,T=re,u=ie,y=me,U=ue,N=_("admin-page-filters"),z=_("AddEdit"),K=_("UserInfo"),F=_("EditOutlined"),I=_e,B=pe,H=ce,L=ye,j=_("admin-page-table-content");return l(),g(b,null,[n(S,null,{header:a(()=>[n(A,{title:e.$t(`menu.payment_${t.paymentType}`),class:"p-0"},null,8,["title"])]),breadcrumb:a(()=>[n(D,{separator:"-",style:{"font-size":"12px"}},{default:a(()=>[n(h,null,{default:a(()=>[n(s,{to:{name:"admin.dashboard.index"}},{default:a(()=>[r(i(e.$t("menu.dashboard")),1)]),_:1},8,["to"])]),_:1}),n(h,null,{default:a(()=>[r(i(e.$t(`menu.${t.menuParent}`)),1)]),_:1}),n(h,null,{default:a(()=>[r(i(e.$t(`menu.payment_${t.paymentType}`)),1)]),_:1})]),_:1})]),_:1}),n(N,null,{default:a(()=>[n(U,{gutter:[16,16]},{default:a(()=>[n(m,{xs:24,sm:24,md:12,lg:10,xl:10},{default:a(()=>[n(C,null,{default:a(()=>[t.permsArray.includes(t.paymentType=="in"?"payment_in_create":"payment_out_create")||t.permsArray.includes("admin")?(l(),f(p,{key:0,type:"primary",onClick:e.addItem},{default:a(()=>[n(P),r(" "+i(e.$t("payments.add")),1)]),_:1},8,["onClick"])):c("",!0),e.table.selectedRowKeys.length>0&&(t.permsArray.includes(t.paymentType=="in"?"payment_in_delete":"payment_out_delete")||t.permsArray.includes("admin"))?(l(),f(p,{key:1,type:"primary",onClick:e.showSelectedDeleteConfirm,danger:""},{icon:a(()=>[n(v)]),default:a(()=>[r(" "+i(e.$t("common.delete")),1)]),_:1},8,["onClick"])):c("",!0)]),_:1})]),_:1}),n(m,{xs:24,sm:24,md:12,lg:14,xl:14},{default:a(()=>[n(U,{gutter:[16,16],justify:"end"},{default:a(()=>[n(m,{xs:24,sm:24,md:12,lg:6,xl:8},{default:a(()=>[n(y,{compact:""},{default:a(()=>[n(T,{style:{width:"25%"},value:e.table.searchColumn,"onUpdate:value":d[0]||(d[0]=o=>e.table.searchColumn=o),placeholder:e.$t("common.select_default_text",[""])},{default:a(()=>[(l(!0),g(b,null,R(t.filterableColumns,o=>(l(),f(w,{key:o.key},{default:a(()=>[r(i(o.value),1)]),_:2},1024))),128))]),_:1},8,["value","placeholder"]),n(u,{style:{width:"75%"},value:e.table.searchString,"onUpdate:value":d[1]||(d[1]=o=>e.table.searchString=o),"show-search":"",onChange:e.onTableSearch,onSearch:e.onTableSearch,loading:e.table.filterLoading},null,8,["value","onChange","onSearch","loading"])]),_:1})]),_:1}),n(m,{xs:24,sm:24,md:12,lg:6,xl:6},{default:a(()=>[n(T,{value:t.filters.user_id,"onUpdate:value":d[2]||(d[2]=o=>t.filters.user_id=o),placeholder:e.$t("common.select_default_text",[e.$t("user.user")]),allowClear:!0,style:{width:"100%"},optionFilterProp:"title","show-search":"",onChange:t.setUrlData},{default:a(()=>[(l(!0),g(b,null,R(t.users,o=>(l(),f(w,{key:o.xid,title:o.name,value:o.xid},{default:a(()=>[r(i(o.name),1)]),_:2},1032,["title","value"]))),128))]),_:1},8,["value","placeholder","onChange"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),n(j,null,{default:a(()=>[n(z,{addEditType:e.addEditType,visible:e.addEditVisible,url:e.addEditUrl,onAddEditSuccess:e.addEditSuccess,onClosed:e.onCloseAddEdit,formData:e.formData,data:e.viewData,pageTitle:e.pageTitle,successMessage:e.successMessage},null,8,["addEditType","visible","url","onAddEditSuccess","onClosed","formData","data","pageTitle","successMessage"]),n(U,null,{default:a(()=>[n(m,{span:24},{default:a(()=>[ae("div",Ae,[n(L,{"row-selection":{selectedRowKeys:e.table.selectedRowKeys,onChange:e.onRowSelectChange,getCheckboxProps:o=>({disabled:!1,name:o.xid})},columns:t.columns,"row-key":o=>o.xid,"data-source":e.table.data,pagination:e.table.pagination,loading:e.table.loading,onChange:e.handleTableChange,bordered:"",size:"middle"},{bodyCell:a(({column:o,record:k})=>[o.dataIndex==="date"?(l(),g(b,{key:0},[r(i(t.formatDate(k.date)),1)],64)):c("",!0),o.dataIndex==="user_id"?(l(),f(K,{key:1,user:k.user},null,8,["user"])):c("",!0),o.dataIndex==="amount"?(l(),g(b,{key:2},[r(i(t.formatAmountCurrency(k.amount)),1)],64)):c("",!0),o.dataIndex==="action"?(l(),g(b,{key:3},[t.permsArray.includes(t.paymentType=="in"?"payment_in_edit":"payment_out_edit")||t.permsArray.includes("admin")?(l(),f(p,{key:0,type:"primary",onClick:q=>e.editItem(k),style:{"margin-left":"4px"}},{icon:a(()=>[n(F)]),_:2},1032,["onClick"])):c("",!0),t.permsArray.includes(t.paymentType=="in"?"payment_in_delete":"payment_out_delete")||t.permsArray.includes("admin")?(l(),f(p,{key:1,type:"primary",onClick:q=>e.showDeleteConfirm(k.xid),style:{"margin-left":"4px"}},{icon:a(()=>[n(v)]),_:2},1032,["onClick"])):c("",!0)],64)):c("",!0)]),summary:a(()=>[n(H,null,{default:a(()=>[n(I,{"col-span":3}),n(I,{"col-span":1},{default:a(()=>[n(B,{strong:""},{default:a(()=>[r(i(e.$t("common.total")),1)]),_:1})]),_:1}),n(I,{"col-span":1},{default:a(()=>[n(B,{strong:""},{default:a(()=>[r(i(t.formatAmountCurrency(t.totals.totalAmount)),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["row-selection","columns","row-key","data-source","pagination","loading","onChange"])])]),_:1})]),_:1})]),_:1})],64)}const ze=G(ke,[["render",we]]);export{ze as default};
