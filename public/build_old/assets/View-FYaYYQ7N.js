import{_ as C,d as k,b as I,r as h,o as r,i as b,w as a,a as n,l,t as u,c as $,k as y,H as B,Y as D,E as N,a6 as O,V as K,G as U,aL as S,aM as W,aN as E,J as F,q as T,h as V,f as H,an as M,ao as L,j as R,al as j,aO as q,aP as G,ap as J}from"./app-DvNATx7Y.js";import{a as P,A as Y}from"./ArrowUpOutlined-DaaFLsNr.js";import{d as z}from"./datatable-ChDCLVWf.js";import{U as Q}from"./UserInfo-BLXDo1tT.js";const X=k({props:["amount"],components:{ArrowDownOutlined:P,ArrowUpOutlined:Y},setup(){const{formatAmountCurrency:e}=I();return{formatAmountCurrency:e}}}),Z={key:0};function x(e,o,p,d,g,i){const _=h("ArrowUpOutlined"),s=B,t=h("ArrowDownOutlined");return e.amount<0?(r(),b(s,{key:0,title:e.$t("payments.you_will_pay")},{default:a(()=>[n(_,{style:{color:"red"}}),l(" "+u(e.formatAmountCurrency(Math.abs(e.amount))),1)]),_:1},8,["title"])):(r(),b(s,{key:1,title:e.$t("payments.you_will_receive")},{default:a(()=>[e.amount>0?(r(),$("span",Z,[n(t,{style:{color:"green"}})])):y("",!0),l(" "+u(e.formatAmountCurrency(e.amount)),1)]),_:1},8,["title"]))}const ee=C(X,[["render",x]]),te=()=>{const{t:e}=D(),o=["user_id"],p=[{key:"name",value:e("user.name")}],d=[{title:e("payments.date"),dataIndex:"date"},{title:e("payments.transaction_number"),dataIndex:"transaction_number"},{title:e("payments.payment_type"),dataIndex:"payment_type"},{title:e("payments.user"),dataIndex:"user_id"},{title:e("payments.amount"),dataIndex:"amount"}];return{transactionsFilterableColumns:p,transactionsColumns:d,transactionsHashableColumns:o}},ne=k({props:{user_id:null,result_type:{default:"all",type:String}},components:{UserInfo:Q},setup(e){const{transactionsColumns:o,transactionsHashableColumns:p}=te(),{formatDate:d,formatAmountCurrency:g}=I(),i=z();N(()=>{_(e)});const _=t=>{const m={},c={result_type:t.result_type};t.user_id&&t.user_id!=null&&(c.user_id=t.user_id),i.tableUrl.value={url:"warehouse-history?fields=id,xid,date,type,amount,transaction_number,user_id,x_user_id,user{id,xid,name,profile_image,profile_image_url,user_type}",filters:m,extraFilters:c},i.hashable.value=[...p],i.table.sorter={field:"date",order:"asc"},i.fetch({page:1})};O(e,(t,m)=>{_(t)});const s=K(()=>{let t=0;return i.table.data.forEach(m=>{t+=m.amount}),{totalAmount:t}});return{transactionsColumns:o,...i,totals:s,formatDate:d,formatAmountCurrency:g}}}),ae={key:0,class:"table-responsive"};function se(e,o,p,d,g,i){const _=h("UserInfo"),s=S,t=W,m=E,c=F,v=T,A=V;return r(),b(A,null,{default:a(()=>[n(v,{span:24},{default:a(()=>[e.table.loading?y("",!0):(r(),$("div",ae,[n(c,{columns:e.transactionsColumns,"row-key":f=>f.xid,"data-source":e.table.data,pagination:e.table.pagination,loading:e.table.loading,onChange:e.handleTableChange},{bodyCell:a(({column:f,record:w})=>[f.dataIndex==="date"?(r(),$(U,{key:0},[l(u(e.formatDate(w.date)),1)],64)):y("",!0),f.dataIndex==="payment_type"?(r(),$(U,{key:1},[l(u(w.type),1)],64)):y("",!0),f.dataIndex==="user_id"?(r(),b(_,{key:2,user:w.user,showLink:!1},null,8,["user"])):y("",!0),f.dataIndex==="amount"?(r(),$(U,{key:3},[l(u(e.formatAmountCurrency(w.amount)),1)],64)):y("",!0)]),summary:a(()=>[n(m,null,{default:a(()=>[n(s,{"col-span":3}),n(s,{"col-span":1},{default:a(()=>[n(t,{strong:""},{default:a(()=>[l(u(e.$t("common.total")),1)]),_:1})]),_:1}),n(s,{"col-span":1},{default:a(()=>[n(t,{strong:""},{default:a(()=>[l(u(e.formatAmountCurrency(e.totals.totalAmount)),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["columns","row-key","data-source","pagination","loading","onChange"])]))]),_:1})]),_:1})}const oe=C(ne,[["render",se]]),re=k({props:["user"],components:{Transactions:oe},setup(){return{activeKey:H("transactions")}}});function le(e,o,p,d,g,i){const _=h("Transactions"),s=M,t=L;return r(),b(t,{activeKey:e.activeKey,"onUpdate:activeKey":o[0]||(o[0]=m=>e.activeKey=m)},{default:a(()=>[n(s,{key:"transactions",tab:e.$t("payments.transactions")},{default:a(()=>[n(_,{user_id:e.user.xid,result_type:e.user.user_type=="staff_members"?"staff_member":"customer_supplier"},null,8,["user_id","result_type"])]),_:1},8,["tab"])]),_:1},8,["activeKey"])}const ue=C(re,[["render",le]]),ie=k({props:["user","visible"],emits:["closed"],components:{UserBalance:ee,UserDetails:ue},setup(e,{emit:o}){const{formatAmountCurrency:p}=I();return D(),{formatAmountCurrency:p,onClose:()=>{o("closed")},drawerWidth:window.innerWidth<=991?"90%":"60%"}}}),_e={class:"user-details"};function me(e,o,p,d,g,i){const _=j,s=T,t=q,m=G,c=V,v=h("UserDetails"),A=J;return r(),b(A,{title:e.user.name,width:e.drawerWidth,open:e.visible,"body-style":{paddingBottom:"80px"},maskClosable:!1,onClose:e.onClose},{default:a(()=>[R("div",_e,[n(c,{gutter:[16,16]},{default:a(()=>[n(s,{xs:24,sm:24,md:4,lg:4},{default:a(()=>[n(_,{src:e.user.profile_image_url},null,8,["src"])]),_:1}),n(s,{xs:24,sm:24,md:20,lg:20},{default:a(()=>[n(m,{title:e.$t(`user.${e.user.user_type}_details`),layout:"vertical",contentStyle:{fontWeight:500,marginBottom:"20px"}},{default:a(()=>[n(t,{label:e.$t("user.name")},{default:a(()=>[l(u(e.user.name),1)]),_:1},8,["label"]),n(t,{label:e.$t("user.email")},{default:a(()=>[l(u(e.user.email),1)]),_:1},8,["label"]),n(t,{label:"NRC Number"},{default:a(()=>[l(u(e.user.phone?e.user.phone:"-"),1)]),_:1}),n(t,{label:e.$t("user.billing_address"),span:2},{default:a(()=>[l(u(e.user.address?e.user.address:"-"),1)]),_:1},8,["label"])]),_:1},8,["title"])]),_:1})]),_:1})]),n(v,{user:e.user},null,8,["user"])]),_:1},8,["title","width","open","onClose"])}const ye=C(ie,[["render",me]]);export{oe as T,ee as U,ye as a};
