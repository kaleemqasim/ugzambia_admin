import{_ as U,f as b,a6 as D,E as T,r as I,o as d,c as p,a as n,w as l,b8 as P,av as B,l as c,j as t,bf as S,bl as R,bm as O,G as V,M as F,i as E,bn as H,k as j,ay as q,aB as G,aC as L,n as J,B as K,F as Q,aG as W,aD as X,bo as Y,t as u,s as Z,b0 as $,b1 as ee}from"./app-DvNATx7Y.js";import{A as te}from"./AdminPageHeader-BPh6CuL6.js";import"./index-CvRpe2mf.js";const ae={components:{AdminPageHeader:te},setup(){const r=b({search:"",currentPeriod:null,previousPeriod:null,showNonMatchingOnly:!1}),s=b([]),w=b([]),e=b({current:1,pageSize:10,total:0}),y=b(!1),h=async()=>{const{search:o,currentPeriod:i,previousPeriod:m,showNonMatchingOnly:a}=r.value;if(i!==null&&m!==null&&(!i||m&&parseInt(i)<=parseInt(m))){P.error("Invalid period selection. Current Period must be after Previous Period.");return}console.log("fetchData called"),y.value=!0;try{const k=await B.get("https://api.ugzambia.net/api/all-data-get",{params:{search:o,currentPeriod:i,previousPeriod:m,showNonMatchingOnly:a,page:e.value.current,pageSize:e.value.pageSize}});s.value=k.data.total_data||[],e.value.total=k.data.total_count||0}catch(k){console.error("Fetch data error:",k),P.error("Failed to fetch data.")}finally{y.value=!1}},M=async()=>{try{const i=(await B.get("https://api.ugzambia.net/api/data-import-period")).data.import_period.filter(m=>/^[0-9]{6}$/.test(m));w.value=i}catch(o){console.error("Failed to fetch import periods:",o),P.error("Failed to fetch import periods.")}},g=()=>{const{currentPeriod:o,previousPeriod:i}=r.value;o&&i&&parseInt(i)>=parseInt(o)&&(P.error("Previous Period cannot be greater than or equal to Current Period."),r.value.previousPeriod="")};D(()=>r.value.currentPeriod,g),D(()=>r.value.previousPeriod,g);const v=()=>{r.value.search="",r.value.currentPeriod=null,r.value.previousPeriod=null,r.value.showNonMatchingOnly=!1,h()},N=o=>{o>0&&o<=Math.ceil(e.value.total/e.value.pageSize)&&(e.value.current=o,h())},z=o=>{e.value.pageSize=o,e.value.current=1,h()},f=o=>{P.info(`Action for ${o.id}`)},C=o=>o.isMatching?{backgroundColor:"#ffffff"}:{backgroundColor:"#ec7316"},x=o=>o?{backgroundColor:"#52c41a",color:"#fff",borderColor:"#52c41a"}:{backgroundColor:"#faad14",color:"#fff",borderColor:"#faad14"},_=(o,i)=>`Total ${o} items`;return T(()=>{h(),M()}),D(r,o=>{e.value.current=1,h()},{deep:!0}),{filters:r,tableData:s,pagination:e,loading:y,fetchData:h,handlePageChange:N,handlePageSizeChange:z,handleAction:f,validateDates:g,clearFilters:v,getRowStyle:C,getButtonStyle:x,showTotal:_,importPeriods:w}}},A=r=>($("data-v-0f10e884"),r=r(),ee(),r),oe={class:"filters"},ne=["value"],le=["value"],re=A(()=>t("label",{for:"checkbox"},"Check Missing Member",-1)),se={key:0,class:"loader-container"},ie=A(()=>t("div",{class:"loader"},null,-1)),ce=[ie],ue={key:1,class:"table-container"},de={class:"custom-table"},pe=A(()=>t("thead",null,[t("tr",null,[t("th",null,"Province"),t("th",null,"District"),t("th",null,"Ministry"),t("th",null,"Employee No"),t("th",null,"Man No"),t("th",null,"NRC No"),t("th",null,"Names"),t("th",null,"Period Name"),t("th",null,"Import At")])],-1)),_e={class:"pagination-container"},me={class:"pagination-controls"},he={class:"custom-pagination"};function fe(r,s,w,e,y,h){const M=q,g=I("router-link"),v=G,N=L,z=I("AdminPageHeader"),f=J,C=K,x=Q,_=W,o=X,i=Y,m=I("admin-page-table-content");return d(),p("div",null,[n(z,null,{header:l(()=>[n(M,{title:"Member Check",class:"p-0"})]),breadcrumb:l(()=>[n(N,{separator:"-",style:{"font-size":"12px"}},{default:l(()=>[n(v,null,{default:l(()=>[n(g,{to:{name:"admin.dashboard.index"}},{default:l(()=>[c(" Dashboard ")]),_:1},8,["to"])]),_:1}),n(v,null,{default:l(()=>[c("User")]),_:1}),n(v,null,{default:l(()=>[c("Member")]),_:1})]),_:1})]),_:1}),n(m,null,{default:l(()=>[t("div",oe,[n(x,{model:e.filters,layout:"inline"},{default:l(()=>[n(f,{label:"Search"},{default:l(()=>[S(t("input",{type:"text","onUpdate:modelValue":s[0]||(s[0]=a=>e.filters.search=a),placeholder:"Search",class:"custom-input"},null,512),[[R,e.filters.search]])]),_:1}),n(f,{label:"Current Period"},{default:l(()=>[S(t("select",{"onUpdate:modelValue":s[1]||(s[1]=a=>e.filters.currentPeriod=a),placeholder:"Select Current Period",class:"custom-input"},[(d(!0),p(V,null,F(e.importPeriods,a=>(d(),p("option",{key:a,value:a},u(a),9,ne))),128))],512),[[O,e.filters.currentPeriod]])]),_:1}),n(f,{label:"Previous Period"},{default:l(()=>[S(t("select",{"onUpdate:modelValue":s[2]||(s[2]=a=>e.filters.previousPeriod=a),placeholder:"Select Previous Period",class:"custom-input"},[(d(!0),p(V,null,F(e.importPeriods,a=>(d(),p("option",{key:a,value:a},u(a),9,le))),128))],512),[[O,e.filters.previousPeriod]])]),_:1}),e.filters.currentPeriod&&e.filters.previousPeriod?(d(),E(f,{key:0},{default:l(()=>[S(t("input",{class:"custom-input",type:"checkbox",id:"checkbox","onUpdate:modelValue":s[3]||(s[3]=a=>e.filters.showNonMatchingOnly=a)},null,512),[[H,e.filters.showNonMatchingOnly]]),re]),_:1})):j("",!0),n(f,null,{default:l(()=>[n(C,{type:"primary",onClick:e.fetchData},{default:l(()=>[c("Search")]),_:1},8,["onClick"]),n(C,{type:"default",onClick:e.clearFilters,class:"btn-refresh btn-warning"},{default:l(()=>[c("Refresh")]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model"])]),e.loading?(d(),p("div",se,ce)):(d(),p("div",ue,[t("table",de,[pe,t("tbody",null,[(d(!0),p(V,null,F(e.tableData,a=>(d(),p("tr",{key:a.id,style:Z(e.getRowStyle(a))},[t("td",null,u(a.province),1),t("td",null,u(a.district),1),t("td",null,u(a.ministry),1),t("td",null,u(a.employeeNo),1),t("td",null,u(a.manNo),1),t("td",null,u(a.nrcNo),1),t("td",null,u(a.names),1),t("td",null,u(a.periodName),1),t("td",null,u(a.importAt),1)],4))),128))])])])),t("div",_e,[t("div",me,[n(o,{modelValue:e.pagination.pageSize,"onUpdate:modelValue":s[4]||(s[4]=a=>e.pagination.pageSize=a),onChange:e.handlePageSizeChange,style:{width:"120px"}},{default:l(()=>[n(_,{value:"10"},{default:l(()=>[c("10 items per page")]),_:1}),n(_,{value:"25"},{default:l(()=>[c("25 items per page")]),_:1}),n(_,{value:"50"},{default:l(()=>[c("50 items per page")]),_:1}),n(_,{value:"100"},{default:l(()=>[c("100 items per page")]),_:1}),n(_,{value:"500"},{default:l(()=>[c("500 items per page")]),_:1}),n(_,{value:"1000"},{default:l(()=>[c("1000 items per page")]),_:1})]),_:1},8,["modelValue","onChange"]),t("div",he,[n(i,{current:e.pagination.current,total:e.pagination.total,"page-size":e.pagination.pageSize,onChange:e.handlePageChange,"show-size-changer":"","show-quick-jumper":"","show-total":e.showTotal,style:{flex:"1"}},null,8,["current","total","page-size","onChange","show-total"])])])])]),_:1})])}const Pe=U(ae,[["render",fe],["__scopeId","data-v-0f10e884"]]);export{Pe as default};
